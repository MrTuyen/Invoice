function SetVietNameInterface(n){n.datepicker("option","monthNames",["Tháng một","Tháng hai","Tháng ba","Tháng bốn","Tháng năm","Tháng sáu","Tháng bảy","Tháng tám","Tháng chín","Tháng mười","Tháng mười một","Tháng mười hai"]);n.datepicker("option","monthNamesShort",["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"]);n.datepicker("option","dayNamesShort",["CN","T2","T3","T4","T5","T6","T7"]);n.datepicker("option","dayNamesMin",["CN","T2","T3","T4","T5","T6","T7"]);n.datepicker("option","dayNames",["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"])}function SetDateTimePicker(n){n.datetimepicker({maxDate:null,dateFormat:"dd/mm/yy"});SetVietNameInterface(n)}function SetDatePicker(n){n.datepicker({maxDate:null,dateFormat:"dd/mm/yy"});SetVietNameInterface(n)}function fdelFromAreaPrice(n){var t,i,r;if(!confirm("Xác nhận xóa?"))return!1;if(t=$("#"+$(n).attr("rel")),i=$(n).attr("data-remove"),i==""){t.hide("fast",function(){t.remove()});return}return r="del"+Math.round((new Date).getTime()+Math.random()*100),$.ajax({url:"/Products/Deletespecial/"+r,type:"POST",data:{salepriceid:i},success:function(){t.hide("fast",function(){t.remove()})},error:function(n){alert("Lỗi???\n"+n.responseText)}}),!0}function onsubmitform(n){var t=$(n),i="var"+Math.round((new Date).getTime()+Math.random()*100),r=t.attr("action")+"/"+i;return $.ajax({url:r,type:"POST",data:t.serializeArray(),success:function(n){t.find(".cmddel_special_price").attr("data-remove",n.responseId);t.find('input[name="hSalepriceID"]').val(n.responseId);alert(n.responseText)},error:function(n){alert("Lỗi truyền dữ liệu, thông tin chưa lưu.\n"+n.responseText)}}),!1}function autoSalePrice(n){var t=$(n),r=t.val(),i=t.parent().parent().find('input[name="COSTPRICE"]').val(),u=r/100*i+parseInt(i);t.parent().parent().find('input[name="SALEPRICE"]').val(Math.floor(u/100)*100)}function autoPercentage(n){var t=$(n),r=parseInt(t.val()),i=parseInt(t.parent().parent().find('input[name="COSTPRICE"]').val()),u=t.parent().parent().find('input[name="PROFITPERCENTAGE"]');r-i<=0?u.val(0):u.val((r-i)/i*100)}function autoSalePriceByCost(n){var t=$(n),r=parseInt(t.val()),i=t.parent().parent().find('input[name="PROFITPERCENTAGE"]'),f=t.parent().parent().find('input[name="SALEPRICE"]'),e=numeral(i.val()).format("0,0.00"),u;i.val()==""&&i.val(0);u=e/100*r+r;f.val(Math.floor(u/100)*100)}function uniqueCheckRadio(n){var t=$(n),i=t.parent().find('input[name="pricespecial"]'),r=i.val();t.parent().parent().find('input[name="pricespecial"]').val(0);i.val(r)}function loadCustomer(n){var t=$("#CustomerName"),r=$("#CustomerAddress"),u=$("#CustomerId"),i;return t.text()==""&&n.val()!=""&&(i="var"+Math.round((new Date).getTime()+Math.random()*100),$.post("/SearchInputVoucher/GetCustomer",{custax:n.val(),randomUnique:i}).done(function(i){i.responseName!=""?(t.text(i.responseName),r.text(i.responseAddress),u.val(i.responseId)):(alert("Không thể tìm thấy nhà cung cấp có mã số thuế: "+n.val()),n.focus())}).fail(function(){alert("Lỗi không thể tìm nhà cung cấp")})),!1}function delTableRow(n){if(!confirm("Bạn chắc chắn muốn xóa dòng này?"))return!1;n.parent().hide("fast",function(){n.parent().remove();$("#listRowDetail tr:not(:hidden)").length<=0&&($("select[name='VATInput']").val(0),$("#VoucherDiscount").val(0),$("#totalVoucherMoney").val(0),$("#totalVATVoucher").val(0),$("#TotalAmountVoucher").val(0));updateTotalMoney();updateTotalDiscount()})}function popupSelectOneProduct(n,t){var i=JSON.parse(n),r,u;i.length==1?t(i[0]):i.length>1&&(r=$('<div class="popupSelectOneProduct">'),u=0,i.forEach(function(n){var f="id"+n.ProductID,e=$('<input type="radio"/>').attr("id",f).attr("name","UserSelectedProductID").val(u).keyup(function(n){if(n.keyCode==13){var r=$(this).val();t(i[r]);$(".popupSelectOneProduct").dialog("close")}}),o=$("<label/>").attr("for",f).text(" "+n.ProductName+"("+n.UnitName+")").css("color","#188338").prepend(e),s=$("<p/>").append(o);r.append(s);u++}),r.dialog({title:"Chọn sản phẩm",modal:!0,resizable:!1,width:600,height:250,close:function(){$(".popupSelectOneProduct").remove()},buttons:[{text:"Ok",icons:{primary:"ui-icon-heart"},click:function(){var n=$('input[name="UserSelectedProductID"]:checked').val();t(i[n]);$(this).dialog("close")}}]}))}function loadProduct(n){var t=n.parent().parent(),l=n,r=t.find('span[data-field="ProductName"]'),f=t.find('input[name="QUANTITYUNITID"]'),e=t.find('span[data-field="UnitName"]'),o=t.find('input[name="Quantity"]'),s=t.find('span[data-field="Price"]'),h=t.find('input[name="ToMoney"]'),c=t.find('input[name="Discount"]'),i,u;return r.text()==""&&n.val()!=""&&(i=0,$("#listRowDetail tr:not(:hidden) input[name='ProductID']").each(function(){$(this).val()==n.val()&&i++}),i>2?(alert("Sản phẩm đã tồn tại, vui lòng kiểm tra lại"),n.val(""),n.focus()):(u="var"+Math.round((new Date).getTime()+Math.random()*100),$.post("/SearchInputVoucher/GetProduct",{productid:n.val(),InputTypeInput:$("#InputTypeInput").val(),randomUnique:u}).done(function(t){if(t.success)var i=function(t){n.val(t.ProductID.trim());r.text(t.ProductName);e.text(t.UnitName);o.val(1);s.val(0);h.val(0);c.val(0);f.val(t.UnitID)},u=popupSelectOneProduct(t.jsobj,i);else alert("Không tìm thấy sản phẩm: "+n.val()),n.focus()}).fail(function(){alert("Lỗi không thể tìm sản phẩm")}))),!1}function updateTotalMoney(n){var i;if(n!=null){var t=n.parent().parent(),r=parseFloat(t.find('input[name="Quantity"]').autoNumeric("get")),u=parseInt(t.find('input[name="ToMoney"]').autoNumeric("get"))/r;t.find("span[data-field='Price']").text($.number(u,2))}i=0;$("#listRowDetail tr:not(:hidden) input[name='ToMoney']").each(function(){$(this).val()!=""&&(i+=parseInt($(this).autoNumeric("get")))});$("#sumToTalMoneyRow").val(i);updateSumMoneyVoucher()}function updateSumMoneyVoucher(){var n=0,t=parseInt($("#sumToTalMoneyRow").val()),i=parseInt($("#sumToTalDiscountRow").val()),r=parseInt($("#VoucherDiscount").autoNumeric("get")),o=parseInt($("select[name='VATInput']").val()),f=$("#totalVoucherMoney"),e=$("#totalVATVoucher"),u=t-i-r,s=t-i;$("#listRowDetail tr:not(:hidden)").each(function(){var i=parseInt($(this).find("input[name='ToMoney']").autoNumeric("get")),u=parseInt($(this).find("input[name='Discount']").autoNumeric("get")),f=parseInt($(this).find("select[name='VAT']").val());n+=f/100*(i-u-r/t*i)});f.val(u);e.val(n);$("#TotalAmountVoucher").val(u+n)}function updateTotalDiscount(){var n=0;$("tr:not(:hidden) input[name='Discount']").each(function(){$(this).val()!=""&&(n+=parseInt($(this).autoNumeric("get")))});$("#sumToTalDiscountRow").val(n);updateSumMoneyVoucher()}function checkVoucherDiscount(n){var t=parseInt($(n).autoNumeric("get")),i=parseInt($("#sumToTalMoneyRow").val());t>i&&(alert("Chiết khấu (theo hóa đơn) phải nhỏ hơn hoặc bằng tổng thành tiền: "),setTimeout(function(){n.focus()},10))}function hiddenRow(n){return confirm("Bạn chắc chắn muốn xóa dòng này?")&&n.parent().hide(300,function(){$(this).remove()}),!1}function getDecimalSeparator(){return(3/2).toLocaleString().substring(1,2)}function openPopupSelectProduct(n,t,i){var r=$(n);r.attr("disabled","disabled");callbackExec=t;i=i==null?0:i;$.post("/Common/SelectProduct",{storeid:i}).done(function(n){var t=$('<div class="popupselectproduct"/>').dialog({title:"Chọn sản phẩm",modal:!0,resizable:!1,width:1e3,height:650,close:function(){r.removeAttr("disabled");$(".popupselectproduct").remove();setTimeout(function(){callbackExec(null)},500)}});t.html(n)})}function openPopupSelectItems(n,t){var i=$(n);i.attr("disabled","disabled");callbackExec=t;$.post("/Common/SelectItems").done(function(n){var t=$('<div class="popupselectproduct"/>').dialog({title:"Chọn Item",modal:!0,resizable:!1,width:800,height:670,close:function(){i.removeAttr("disabled");$(".popupselectproduct").remove()}});t.html(n)})}function openPopupSelectMarket(n,t,i){var r=$(n);r.attr("disabled","disabled");callbackExec=i;$.post("/Common/SelectMarket",t).done(function(n){var t=$('<div class="popupselectproduct"/>').dialog({title:"Chọn chợ",modal:!0,resizable:!1,width:1e3,height:600,close:function(){r.removeAttr("disabled");$(".popupselectproduct").remove()}});t.html(n)})}function openPopupSelectCombo(n,t){var i=$(n);i.attr("disabled","disabled");callbackExec=t;$.post("/Common/SelectCombo").done(function(n){var t=$('<div class="popupselectproduct"/>').dialog({title:"Chọn Combo",modal:!0,resizable:!1,width:1e3,height:600,close:function(){i.removeAttr("disabled");$(".popupselectproduct").remove()}});t.html(n)})}function openPopupSelectStore(n,t,i){var r=$(n);r.attr("disabled","disabled");callbackExec=i;$.post("/Common/SelectStore",t).done(function(n){var t=$('<div class="popupselectproduct"/>').dialog({title:"Chọn siêu thị",modal:!0,resizable:!1,width:1e3,height:600,close:function(){r.removeAttr("disabled");$(".popupselectproduct").remove()}});t.html(n)})}function RefreshSession(){var n="var"+Math.round((new Date).getTime()+Math.random()*100),t="/Account/RefreshSession/"+n;$.post(t,{}).done(function(n){n?(console.log(n.msg),n.rs||window.location.href.indexOf("Account/Login")==-1&&window.location.reload()):console.log("Lỗi không nhận được phản hồi - RefreshSession (js) ")}).fail(function(){console.log(response.msg)})}var lstDependency,app,timerId,callbackExec,$POSloading;(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","jquery.ui.widget"],n):n(window.jQuery)})(function(n){"use strict";n.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);n.support.xhrFormDataFileUpload=!!window.FormData;n.widget("blueimp.fileupload",{options:{dropZone:n(document),pasteZone:n(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,formData:function(n){return n.serializeArray()},add:function(t,i){(i.autoUpload||i.autoUpload!==!1&&(n(this).data("blueimp-fileupload")||n(this).data("fileupload")).options.autoUpload)&&i.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date;this.loaded=0;this.bitrate=0;this.getBitrate=function(n,t,i){var r=n-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=n),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&n.support.xhrFileUpload||n.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return typeof t.formData=="function"?t.formData(t.form):n.isArray(t.formData)?t.formData:t.formData?(i=[],n.each(t.formData,function(n,t){i.push({name:n,value:t})}),i):[]},_getTotal:function(t){var i=0;return n.each(t,function(n,t){i+=t.size||1}),i},_initProgressObject:function(n){n._progress={loaded:0,total:0,bitrate:0}},_onProgress:function(n,t){if(n.lengthComputable){var i=+new Date,r;if(t._time&&t.progressInterval&&i-t._time<t.progressInterval&&n.loaded!==n.total)return;t._time=i;r=Math.floor(n.loaded/n.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0);this._progress.loaded+=r-t._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,t.bitrateInterval);t._progress.loaded=t.loaded=r;t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(i,r,t.bitrateInterval);this._trigger("progress",n,t);this._trigger("progressall",n,this._progress)}},_initProgressListener:function(t){var r=this,i=t.xhr?t.xhr():n.ajaxSettings.xhr();i.upload&&(n(i.upload).bind("progress",function(n){var i=n.originalEvent;n.lengthComputable=i.lengthComputable;n.loaded=i.loaded;n.total=i.total;r._onProgress(n,t)}),t.xhr=function(){return i})},_initXHRData:function(t){var i,r=t.files[0],f=t.multipart||!n.support.xhrFileUpload,u=t.paramName[0];t.headers=t.headers||{};t.contentRange&&(t.headers["Content-Range"]=t.contentRange);f?n.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:u,value:t.blob}):n.each(t.files,function(n,r){i.push({name:t.paramName[n]||u,value:r})})):(t.formData instanceof FormData?i=t.formData:(i=new FormData,n.each(this._getFormData(t),function(n,t){i.append(t.name,t.value)})),t.blob?(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"',i.append(u,t.blob,r.name)):n.each(t.files,function(n,r){(window.Blob&&r instanceof Blob||window.File&&r instanceof File)&&i.append(t.paramName[n]||u,r,r.name)})),t.data=i):(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"',t.contentType=r.type,t.data=t.blob||r);t.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||"");t.formData=this._getFormData(t);t.redirect&&n("<a><\/a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(n){this._isXHRUpload(n)?(this._chunkedUpload(n,!0)||(n.data||this._initXHRData(n),this._initProgressListener(n)),n.postMessage&&(n.dataType="postmessage "+(n.dataType||""))):this._initIframeSettings(n,"iframe")},_getParamName:function(t){var r=n(t.fileInput),i=t.paramName;return i?n.isArray(i)||(i=[i]):(i=[],r.each(function(){for(var t=n(this),u=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(u),r-=1}),i.length||(i=[r.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=n(t.fileInput.prop("form")),t.form.length||(t.form=n(this.options.fileInput.prop("form"))));t.paramName=this._getParamName(t);t.url||(t.url=t.form.prop("action")||location.href);t.type=(t.type||t.form.prop("method")||"").toUpperCase();t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST");t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=n.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(n){return n.state?n.state():n.isResolved()?"resolved":n.isRejected()?"rejected":"pending"},_enhancePromise:function(n){return n.success=n.done,n.error=n.fail,n.complete=n.always,n},_getXHRPromise:function(t,i,r){var u=n.Deferred(),f=u.promise();return i=i||this.options.context||f,t===!0?u.resolveWith(i,r):t===!1&&u.rejectWith(i,r),f.abort=u.promise,this._enhancePromise(f)},_addConvenienceMethods:function(n,t){var i=this;t.submit=function(){return this.state()!=="pending"&&(t.jqXHR=this.jqXHR=i._trigger("submit",n,this)!==!1&&i._onSend(n,this)),this.jqXHR||i._getXHRPromise()};t.abort=function(){return this.jqXHR?this.jqXHR.abort():this._getXHRPromise()};t.state=function(){if(this.jqXHR)return i._getDeferredState(this.jqXHR)};t.progress=function(){return this._progress}},_getUploadedBytes:function(n){var i=n.getResponseHeader("Range"),t=i&&i.split("-"),r=t&&t.length>1&&parseInt(t[1],10);return r&&r+1},_chunkedUpload:function(t,i){var u=this,f=t.files[0],e=f.size,r=t.uploadedBytes=t.uploadedBytes||0,c=t.maxChunkSize||e,l=f.slice||f.webkitSlice||f.mozSlice,o=n.Deferred(),s=o.promise(),a,h;return!(this._isXHRUpload(t)&&l&&(r||c<e))||t.data?!1:i?!0:r>=e?(f.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,t.context,[null,"error",f.error])):(h=function(){var i=n.extend({},t),s=i._progress.loaded;i.blob=l.call(f,r,r+c,f.type);i.chunkSize=i.blob.size;i.contentRange="bytes "+r+"-"+(r+i.chunkSize-1)+"/"+e;u._initXHRData(i);u._initProgressListener(i);a=(u._trigger("chunksend",null,i)!==!1&&n.ajax(i)||u._getXHRPromise(!1,i.context)).done(function(f,c,l){r=u._getUploadedBytes(l)||r+i.chunkSize;i._progress.loaded===s&&u._onProgress(n.Event("progress",{lengthComputable:!0,loaded:r-i.uploadedBytes,total:r-i.uploadedBytes}),i);t.uploadedBytes=i.uploadedBytes=r;i.result=f;i.textStatus=c;i.jqXHR=l;u._trigger("chunkdone",null,i);u._trigger("chunkalways",null,i);r<e?h():o.resolveWith(i.context,[f,c,l])}).fail(function(n,t,r){i.jqXHR=n;i.textStatus=t;i.errorThrown=r;u._trigger("chunkfail",null,i);u._trigger("chunkalways",null,i);o.rejectWith(i.context,[n,t,r])})},this._enhancePromise(s),s.abort=function(){return a.abort()},h(),s)},_beforeSend:function(n,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);t._progress||(t._progress={});t._progress.loaded=t.loaded=t.uploadedBytes||0;t._progress.total=t.total=this._getTotal(t.files)||1;t._progress.bitrate=t.bitrate=0;this._active+=1;this._progress.loaded+=t.loaded;this._progress.total+=t.total},_onDone:function(t,i,r,u){var f=u._progress.total;u._progress.loaded<f&&this._onProgress(n.Event("progress",{lengthComputable:!0,loaded:f,total:f}),u);u.result=t;u.textStatus=i;u.jqXHR=r;this._trigger("done",null,u)},_onFail:function(n,t,i,r){r.jqXHR=n;r.textStatus=t;r.errorThrown=i;this._trigger("fail",null,r);r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total)},_onAlways:function(n,t,i,r){this._active-=1;this._trigger("always",null,r);this._active===0&&this._trigger("stop")},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var r=this,f,s,e,h,u=r._getAJAXSettings(i),o=function(){return r._sending+=1,u._bitrateTimer=new r._BitrateTimer,f=f||((s||r._trigger("send",t,u)===!1)&&r._getXHRPromise(!1,u.context,s)||r._chunkedUpload(u)||n.ajax(u)).done(function(n,t,i){r._onDone(n,t,i,u)}).fail(function(n,t,i){r._onFail(n,t,i,u)}).always(function(n,t,i){if(r._sending-=1,r._onAlways(n,t,i,u),u.limitConcurrentUploads&&u.limitConcurrentUploads>r._sending)for(var f=r._slots.shift();f;){if(r._getDeferredState(f)==="pending"){f.resolve();break}f=r._slots.shift()}})};return(this._beforeSend(t,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)?(this.options.limitConcurrentUploads>1?(e=n.Deferred(),this._slots.push(e),h=e.pipe(o)):h=this._sequence=this._sequence.pipe(o,o),h.abort=function(){return(s=[undefined,"abort","abort"],!f)?(e&&e.rejectWith(u.context,s),o()):f.abort()},this._enhancePromise(h)):o()},_onAdd:function(t,i){var c=this,l=!0,u=n.extend({},this.options,i),f=u.limitMultiFileUploads,s=this._getParamName(u),e,h,o,r;if((u.singleFileUploads||f)&&this._isXHRUpload(u))if(!u.singleFileUploads&&f)for(o=[],e=[],r=0;r<i.files.length;r+=f)o.push(i.files.slice(r,r+f)),h=s.slice(r,r+f),h.length||(h=s),e.push(h);else e=s;else o=[i.files],e=[s];return i.originalFiles=i.files,n.each(o||i.files,function(r,u){var f=n.extend({},i);return f.files=o?u:[u],f.paramName=e[r],c._initProgressObject(f),c._addConvenienceMethods(t,f),l=c._trigger("add",t,f)}),l},_replaceFileInput:function(t){var i=t.clone(!0);n("<form><\/form>").append(i)[0].reset();t.after(i).detach();n.cleanData(t.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(n,r){return r===t[0]?i[0]:r});t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var e=this,r=n.Deferred(),u=function(n){n&&!n.entry&&(n.entry=t);r.resolve([n])},f;return i=i||"",t.isFile?t._file?(t._file.relativePath=i,r.resolve(t._file)):t.file(function(n){n.relativePath=i;r.resolve(n)},u):t.isDirectory?(f=t.createReader(),f.readEntries(function(n){e._handleFileTreeEntries(n,i+t.name+"/").done(function(n){r.resolve(n)}).fail(u)},u)):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var r=this;return n.when.apply(n,n.map(t,function(n){return r._handleFileTreeEntry(n,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(n.map(i,function(n){var t;return n.webkitGetAsEntry?(t=n.webkitGetAsEntry(),t&&(t._file=n.getAsFile()),t):n.getAsEntry()})):n.Deferred().resolve(n.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=n(t);var r=t.prop("webkitEntries")||t.prop("entries"),i,u;if(r&&r.length)return this._handleFileTreeEntries(r);if(i=n.makeArray(t.prop("files")),i.length)i[0].name===undefined&&i[0].fileName&&n.each(i,function(n,t){t.name=t.fileName;t.size=t.fileSize});else{if(u=t.prop("value"),!u)return n.Deferred().resolve([]).promise();i=[{name:u.replace(/^.*\\/,"")}]}return n.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return!(t instanceof n)||t.length===1?this._getSingleFileInputFiles(t):n.when.apply(n,n.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(t){var r=this,i={fileInput:n(t.target),form:n(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(n){i.files=n;r.options.replaceFileInput&&r._replaceFileInput(i.fileInput);r._trigger("change",t,i)!==!1&&r._onAdd(t,i)})},_onPaste:function(t){var r=t.originalEvent.clipboardData,u=r&&r.items||[],i={files:[]};return n.each(u,function(n,t){var r=t.getAsFile&&t.getAsFile();r&&i.files.push(r)}),this._trigger("paste",t,i)===!1||this._onAdd(t,i)===!1?!1:void 0},_onDrop:function(n){var r=this,t=n.dataTransfer=n.originalEvent.dataTransfer,i={};t&&t.files&&t.files.length&&n.preventDefault();this._getDroppedFiles(t).always(function(t){i.files=t;r._trigger("drop",n,i)!==!1&&r._onAdd(n,i)})},_onDragOver:function(t){var i=t.dataTransfer=t.originalEvent.dataTransfer;if(this._trigger("dragover",t)===!1)return!1;i&&n.inArray("Files",i.types)!==-1&&(i.dropEffect="copy",t.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste}));this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(t,i){var r=n.inArray(t,this._refreshOptionsList)!==-1;r&&this._destroyEventHandlers();this._super(t,i);r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof n||(t.fileInput=n(t.fileInput));t.dropZone instanceof n||(t.dropZone=n(t.dropZone));t.pasteZone instanceof n||(t.pasteZone=n(t.pasteZone))},_create:function(){var t=this.options;n.extend(t,n(this.element[0].cloneNode(!1)).data());this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(n){t.files=n;i._onAdd(null,t)}):(t.files=n.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var e=this,i=n.Deferred(),r=i.promise(),u,f;return r.abort=function(){return(f=!0,u)?u.abort():(i.reject(null,"abort","abort"),r)},this._getFileInputFiles(t.fileInput).always(function(n){f||(t.files=n,u=e._onSend(null,t).then(function(n,t,r){i.resolve(n,t,r)},function(n,t,r){i.reject(n,t,r)}))}),this._enhancePromise(r)}if(t.files=n.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})});
/*! AdminLTE app.js
* ================
* Main JS application file for AdminLTE v2. This file
* should be included in all pages. It controls some layout
* options and implements exclusive AdminLTE plugins.
*
* @Author  Almsaeed Studio
* @Support <https://www.almsaeedstudio.com>
* @Email   <abdullah@almsaeedstudio.com>
* @version 2.4.3
* @repository git://github.com/almasaeed2010/AdminLTE.git
* @license MIT <http://opensource.org/licenses/MIT>
*/
if(typeof jQuery=="undefined")throw new Error("AdminLTE requires jQuery");+function(n){"use strict";function u(r){return this.each(function(){var f=n(this),u=f.data(i),o;if(u||(o=n.extend({},e,f.data(),typeof r=="object"&&r),f.data(i,u=new t(f,o))),typeof u=="string"){if(typeof u[r]=="undefined")throw new Error("No method named "+r);u[r]()}})}var i="lte.boxrefresh",e={source:"",params:{},trigger:".refresh-btn",content:".box-body",loadInContent:!0,responseType:"",overlayTemplate:'<div class="overlay"><div class="fa fa-refresh fa-spin"><\/div><\/div>',onLoadStart:function(){},onLoadDone:function(n){return n}},r={data:'[data-widget="box-refresh"]'},t=function(t,i){if(this.element=t,this.options=i,this.$overlay=n(i.overlay),i.source==="")throw new Error("Source url was not defined. Please specify a url in your BoxRefresh source option.");this._setUpListeners();this.load()},f;t.prototype.load=function(){this._addOverlay();this.options.onLoadStart.call(n(this));n.get(this.options.source,this.options.params,function(t){this.options.loadInContent&&n(this.options.content).html(t);this.options.onLoadDone.call(n(this),t);this._removeOverlay()}.bind(this),this.options.responseType!==""&&this.options.responseType)};t.prototype._setUpListeners=function(){n(this.element).on("click",r.trigger,function(n){n&&n.preventDefault();this.load()}.bind(this))};t.prototype._addOverlay=function(){n(this.element).append(this.$overlay)};t.prototype._removeOverlay=function(){n(this.element).remove(this.$overlay)};f=n.fn.boxRefresh;n.fn.boxRefresh=u;n.fn.boxRefresh.Constructor=t;n.fn.boxRefresh.noConflict=function(){return n.fn.boxRefresh=f,this};n(window).on("load",function(){n(r.data).each(function(){u.call(n(this))})})}(jQuery);+function(n){"use strict";function e(t){return this.each(function(){var r=n(this),f=r.data(u),e;if(f||(e=n.extend({},s,r.data(),typeof t=="object"&&t),r.data(u,f=new i(r,e))),typeof t=="string"){if(typeof f[t]=="undefined")throw new Error("No method named "+t);f[t]()}})}var u="lte.boxwidget",s={animationSpeed:500,collapseTrigger:'[data-widget="collapse"]',removeTrigger:'[data-widget="remove"]',collapseIcon:"fa-minus",expandIcon:"fa-plus",removeIcon:"fa-times"},t={data:".box",collapsed:".collapsed-box",header:".box-header",body:".box-body",footer:".box-footer",tools:".box-tools"},f={collapsed:"collapsed-box"},r={collapsed:"collapsed.boxwidget",expanded:"expanded.boxwidget",removed:"removed.boxwidget"},i=function(n,t){this.element=n;this.options=t;this._setUpListeners()},o;i.prototype.toggle=function(){var i=!n(this.element).is(t.collapsed);i?this.collapse():this.expand()};i.prototype.expand=function(){var u=n.Event(r.expanded),e=this.options.collapseIcon,i=this.options.expandIcon;n(this.element).removeClass(f.collapsed);n(this.element).children(t.header+", "+t.body+", "+t.footer).children(t.tools).find("."+i).removeClass(i).addClass(e);n(this.element).children(t.body+", "+t.footer).slideDown(this.options.animationSpeed,function(){n(this.element).trigger(u)}.bind(this))};i.prototype.collapse=function(){var u=n.Event(r.collapsed),i=this.options.collapseIcon,e=this.options.expandIcon;n(this.element).children(t.header+", "+t.body+", "+t.footer).children(t.tools).find("."+i).removeClass(i).addClass(e);n(this.element).children(t.body+", "+t.footer).slideUp(this.options.animationSpeed,function(){n(this.element).addClass(f.collapsed);n(this.element).trigger(u)}.bind(this))};i.prototype.remove=function(){var t=n.Event(r.removed);n(this.element).slideUp(this.options.animationSpeed,function(){n(this.element).trigger(t);n(this.element).remove()}.bind(this))};i.prototype._setUpListeners=function(){var t=this;n(this.element).on("click",this.options.collapseTrigger,function(i){return i&&i.preventDefault(),t.toggle(n(this)),!1});n(this.element).on("click",this.options.removeTrigger,function(i){return i&&i.preventDefault(),t.remove(n(this)),!1})};o=n.fn.boxWidget;n.fn.boxWidget=e;n.fn.boxWidget.Constructor=i;n.fn.boxWidget.noConflict=function(){return n.fn.boxWidget=o,this};n(window).on("load",function(){n(t.data).each(function(){e.call(n(this))})})}(jQuery);+function(n){"use strict";function e(t){return this.each(function(){var r=n(this),f=r.data(u),e;f||(e=n.extend({},s,r.data(),typeof t=="object"&&t),r.data(u,f=new i(r,e)));typeof t=="string"&&f.toggle()})}var u="lte.controlsidebar",s={slide:!0},t={sidebar:".control-sidebar",data:'[data-toggle="control-sidebar"]',open:".control-sidebar-open",bg:".control-sidebar-bg",wrapper:".wrapper",content:".content-wrapper",boxed:".layout-boxed"},r={open:"control-sidebar-open",fixed:"fixed"},f={collapsed:"collapsed.controlsidebar",expanded:"expanded.controlsidebar"},i=function(n,t){this.element=n;this.options=t;this.hasBindedResize=!1;this.init()},o;i.prototype.init=function(){if(!n(this.element).is(t.data))n(this).on("click",this.toggle);this.fix();n(window).resize(function(){this.fix()}.bind(this))};i.prototype.toggle=function(i){i&&i.preventDefault();this.fix();n(t.sidebar).is(t.open)||n("body").is(t.open)?this.collapse():this.expand()};i.prototype.expand=function(){this.options.slide?n(t.sidebar).addClass(r.open):n("body").addClass(r.open);n(this.element).trigger(n.Event(f.expanded))};i.prototype.collapse=function(){n("body, "+t.sidebar).removeClass(r.open);n(this.element).trigger(n.Event(f.collapsed))};i.prototype.fix=function(){n("body").is(t.boxed)&&this._fixForBoxed(n(t.bg))};i.prototype._fixForBoxed=function(i){i.css({position:"absolute",height:n(t.wrapper).height()})};o=n.fn.controlSidebar;n.fn.controlSidebar=e;n.fn.controlSidebar.Constructor=i;n.fn.controlSidebar.noConflict=function(){return n.fn.controlSidebar=o,this};n(document).on("click",t.data,function(t){t&&t.preventDefault();e.call(n(this),"toggle")})}(jQuery);+function(n){"use strict";function u(r){return this.each(function(){var u=n(this),f=u.data(i);f||u.data(i,f=new t(u));typeof r=="string"&&f.toggle(u)})}var i="lte.directchat",r={data:'[data-widget="chat-pane-toggle"]',box:".direct-chat"},e={open:"direct-chat-contacts-open"},t=function(n){this.element=n},f;t.prototype.toggle=function(n){n.parents(r.box).first().toggleClass(e.open)};f=n.fn.directChat;n.fn.directChat=u;n.fn.directChat.Constructor=t;n.fn.directChat.noConflict=function(){return n.fn.directChat=f,this};n(document).on("click",r.data,function(t){t&&t.preventDefault();u.call(n(this),"toggle")})}(jQuery);+function(n){"use strict";function f(t){return this.each(function(){var f=n(this),r=f.data(u),e;if(r||(e=n.extend({},o,f.data(),typeof t=="object"&&t),f.data(u,r=new i(e))),typeof t=="string"){if(typeof r[t]=="undefined")throw new Error("No method named "+t);r[t]()}})}var u="lte.layout",o={slimscroll:!0,resetHeight:!0},t={wrapper:".wrapper",contentWrapper:".content-wrapper",layoutBoxed:".layout-boxed",mainFooter:".main-footer",mainHeader:".main-header",sidebar:".sidebar",controlSidebar:".control-sidebar",fixed:".fixed",sidebarMenu:".sidebar-menu",logo:".main-header .logo"},r={fixed:"fixed",holdTransition:"hold-transition"},i=function(n){this.options=n;this.bindedResize=!1;this.activate()},e;i.prototype.activate=function(){this.fix();this.fixSidebar();n("body").removeClass(r.holdTransition);this.options.resetHeight&&n("body, html, "+t.wrapper).css({height:"auto","min-height":"100%"});this.bindedResize||(n(window).resize(function(){this.fix();this.fixSidebar();n(t.logo+", "+t.sidebar).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){this.fix();this.fixSidebar()}.bind(this))}.bind(this)),this.bindedResize=!0);n(t.sidebarMenu).on("expanded.tree",function(){this.fix();this.fixSidebar()}.bind(this));n(t.sidebarMenu).on("collapsed.tree",function(){this.fix();this.fixSidebar()}.bind(this))};i.prototype.fix=function(){var e,u;n(t.layoutBoxed+" > "+t.wrapper).css("overflow","hidden");var o=n(t.mainFooter).outerHeight()||0,s=n(t.mainHeader).outerHeight()+o,i=n(window).height(),f=n(t.sidebar).height()||0;n("body").hasClass(r.fixed)?n(t.contentWrapper).css("min-height",i-o):(i>=f?(n(t.contentWrapper).css("min-height",i-s),e=i-s):(n(t.contentWrapper).css("min-height",f),e=f),u=n(t.controlSidebar),typeof u!="undefined"&&u.height()>e&&n(t.contentWrapper).css("min-height",u.height()))};i.prototype.fixSidebar=function(){if(!n("body").hasClass(r.fixed)){typeof n.fn.slimScroll!="undefined"&&n(t.sidebar).slimScroll({destroy:!0}).height("auto");return}this.options.slimscroll&&typeof n.fn.slimScroll!="undefined"&&n(t.sidebar).slimScroll({height:n(window).height()-n(t.mainHeader).height()+"px"})};e=n.fn.layout;n.fn.layout=f;n.fn.layout.Constuctor=i;n.fn.layout.noConflict=function(){return n.fn.layout=e,this};n(window).on("load",function(){f.call(n("body"))})}(jQuery);+function(n){"use strict";function f(t){return this.each(function(){var i=n(this),u=i.data(e),f;u||(f=n.extend({},s,i.data(),typeof t=="object"&&t),i.data(e,u=new r(f)));t==="toggle"&&u.toggle()})}var e="lte.pushmenu",s={collapseScreenSize:767,expandOnHover:!1,expandTransitionDelay:200},i={collapsed:".sidebar-collapse",open:".sidebar-open",mainSidebar:".main-sidebar",contentWrapper:".content-wrapper",searchInput:".sidebar-form .form-control",button:'[data-toggle="push-menu"]',mini:".sidebar-mini",expanded:".sidebar-expanded-on-hover",layoutFixed:".fixed"},t={collapsed:"sidebar-collapse",open:"sidebar-open",mini:"sidebar-mini",expanded:"sidebar-expanded-on-hover",expandFeature:"sidebar-mini-expand-feature",layoutFixed:"fixed"},u={expanded:"expanded.pushMenu",collapsed:"collapsed.pushMenu"},r=function(n){this.options=n;this.init()},o;r.prototype.init=function(){(this.options.expandOnHover||n("body").is(i.mini+i.layoutFixed))&&(this.expandOnHover(),n("body").addClass(t.expandFeature));n(i.contentWrapper).click(function(){n(window).width()<=this.options.collapseScreenSize&&n("body").hasClass(t.open)&&this.close()}.bind(this));n(i.searchInput).click(function(n){n.stopPropagation()})};r.prototype.toggle=function(){var r=n(window).width(),i=!n("body").hasClass(t.collapsed);r<=this.options.collapseScreenSize&&(i=n("body").hasClass(t.open));i?this.close():this.open()};r.prototype.open=function(){var i=n(window).width();i>this.options.collapseScreenSize?n("body").removeClass(t.collapsed).trigger(n.Event(u.expanded)):n("body").addClass(t.open).trigger(n.Event(u.expanded))};r.prototype.close=function(){var i=n(window).width();i>this.options.collapseScreenSize?n("body").addClass(t.collapsed).trigger(n.Event(u.collapsed)):n("body").removeClass(t.open+" "+t.collapsed).trigger(n.Event(u.collapsed))};r.prototype.expandOnHover=function(){n(i.mainSidebar).hover(function(){n("body").is(i.mini+i.collapsed)&&n(window).width()>this.options.collapseScreenSize&&this.expand()}.bind(this),function(){n("body").is(i.expanded)&&this.collapse()}.bind(this))};r.prototype.expand=function(){setTimeout(function(){n("body").removeClass(t.collapsed).addClass(t.expanded)},this.options.expandTransitionDelay)};r.prototype.collapse=function(){setTimeout(function(){n("body").removeClass(t.expanded).addClass(t.collapsed)},this.options.expandTransitionDelay)};o=n.fn.pushMenu;n.fn.pushMenu=f;n.fn.pushMenu.Constructor=r;n.fn.pushMenu.noConflict=function(){return n.fn.pushMenu=o,this};n(document).on("click",i.button,function(t){t.preventDefault();f.call(n(this),"toggle")});n(window).on("load",function(){f.call(n(i.button))})}(jQuery);+function(n){"use strict";function u(r){return this.each(function(){var f=n(this),u=f.data(i),o;if(u||(o=n.extend({},e,f.data(),typeof r=="object"&&r),f.data(i,u=new t(f,o))),typeof u=="string"){if(typeof u[r]=="undefined")throw new Error("No method named "+r);u[r]()}})}var i="lte.todolist",e={onCheck:function(n){return n},onUnCheck:function(n){return n}},r={data:'[data-widget="todo-list"]'},o={done:"done"},t=function(n,t){this.element=n;this.options=t;this._setUpListeners()},f;t.prototype.toggle=function(n){if(n.parents(r.li).first().toggleClass(o.done),!n.prop("checked")){this.unCheck(n);return}this.check(n)};t.prototype.check=function(n){this.options.onCheck.call(n)};t.prototype.unCheck=function(n){this.options.onUnCheck.call(n)};t.prototype._setUpListeners=function(){var t=this;n(this.element).on("change ifChanged","input:checkbox",function(){t.toggle(n(this))})};f=n.fn.todoList;n.fn.todoList=u;n.fn.todoList.Constructor=t;n.fn.todoList.noConflict=function(){return n.fn.todoList=f,this};n(window).on("load",function(){n(r.data).each(function(){u.call(n(this))})})}(jQuery);+function(n){"use strict";function e(t){return this.each(function(){var i=n(this),e=i.data(u),f;e||(f=n.extend({},s,i.data(),typeof t=="object"&&t),i.data(u,new r(i,f)))})}var u="lte.tree",s={animationSpeed:500,accordion:!0,followLink:!1,trigger:".treeview a"},t={tree:".tree",treeview:".treeview",treeviewMenu:".treeview-menu",open:".menu-open, .active",li:"li",data:'[data-widget="tree"]',active:".active"},i={open:"menu-open",tree:"tree"},f={collapsed:"collapsed.tree",expanded:"expanded.tree"},r=function(r,u){this.element=r;this.options=u;n(this.element).addClass(i.tree);n(t.treeview+t.active,this.element).addClass(i.open);this._setUpListeners()},o;r.prototype.toggle=function(n,r){var f=n.next(t.treeviewMenu),u=n.parent(),e=u.hasClass(i.open);u.is(t.treeview)&&(this.options.followLink&&n.attr("href")!=="#"||r.preventDefault(),e?this.collapse(f,u):this.expand(f,u))};r.prototype.expand=function(r,u){var s=n.Event(f.expanded),e,o;this.options.accordion&&(e=u.siblings(t.open),o=e.children(t.treeviewMenu),this.collapse(o,e));u.addClass(i.open);r.slideDown(this.options.animationSpeed,function(){n(this.element).trigger(s)}.bind(this))};r.prototype.collapse=function(r,u){var e=n.Event(f.collapsed);r.find(t.open).removeClass(i.open);u.removeClass(i.open);r.slideUp(this.options.animationSpeed,function(){r.find(t.open+" > "+t.treeview).slideUp();n(this.element).trigger(e)}.bind(this))};r.prototype._setUpListeners=function(){var t=this;n(this.element).on("click",this.options.trigger,function(i){t.toggle(n(this),i)})};o=n.fn.tree;n.fn.tree=e;n.fn.tree.Constructor=r;n.fn.tree.noConflict=function(){return n.fn.tree=o,this};n(window).on("load",function(){n(t.data).each(function(){e.call(n(this))})})}(jQuery);lstDependency=[];app=angular.module("onfinance",lstDependency).run();app.directive("onlyNumber",function(){return{restrict:"A",link:function(n,t){t.bind("input",function(){var i=this.selectionStart-1,n=this.value.replace(/[^0-9\.]/g,""),t;n.charAt(0)==="."&&(n=n.slice(1));t=n.indexOf(".")+1;t>=0&&(n=n.substr(0,t)+n.slice(t).replace(".",""));this.value!=n&&(this.value=n,this.selectionStart=i,this.selectionEnd=i)})}}});app.directive("ngMin",function(n){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){t.$watch(r.ngMin,function(){u.$setViewValue(u.$viewValue)});var f=function(i){var f=t.$eval(r.ngMin)||0;return!n.isNullOrEmpty(i)&&i<f?(u.$setValidity("ngMin",!1),undefined):(u.$setValidity("ngMin",!0),i)};u.$parsers.push(f);u.$formatters.push(f)}}});app.directive("ngMax",function(){return{restrict:"A",link:function(n,t,i){t.bind("input",function(){var t=this.value.replace(/[^0-9\.]/g,""),u=parseFloat(n.$eval(i.ngMax))||Infinity,r=parseFloat(t);if(t!=null&&t!=""&&r>u){while(r>u)t=t.slice(0,-1),r=parseFloat(t);this.value=t}})}}});app.directive("focusOn",["$timeout",function(n){var t=function(n){if(!n.focusOn&&n.focusOn!="")throw"FocusOnCondition missing attribute to evaluate";};return{restrict:"A",link:function(i,r,u){t(u);i.$watch(u.focusOn,function(t){t==!0&&n(function(){r.focus()})})}}}]);app.directive("selectOnClick",["$window",function(n){return{restrict:"A",link:function(t,i){i.on("click",function(){n.getSelection().toString()||this.setSelectionRange(0,this.value.length)})}}}]);app.directive("convertToNumber",function(){return{require:"ngModel",link:function(n,t,i,r){r.$parsers.push(function(n){return n!=null?parseInt(n,10):null});r.$formatters.push(function(n){return n!=null?""+n:null})}}});app.directive("customOnChange",["$timeout",function(n){return{restrict:"A",link:function(t,i,r){n(function(){var n=t.$eval(r.customOnChange);i.bind("change",n)},100)}}}]);app.filter("numberFormat",function(){return function(n,t,i,r,u,f){try{if(isNaN(n))return 0;if(n==0){if(f=="true")return"";if(u=="true")return 0}var t=isNaN(t=Math.abs(t))?2:t,r=r==undefined?".":r,i=i==undefined?",":i,s=n<0?"-":"",o=parseInt(n=Math.abs(+n||0).toFixed(t))+"",e=(e=o.length)>3?e%3:0;return s+(e?o.substr(0,e)+i:"")+o.substr(e).replace(/(\d{3})(?=\d)/g,"$1"+i)+(t?r+Math.abs(n-o).toFixed(t).slice(2):"")}catch(h){return n}}});app.filter("dateTimeFormat",function(n){function t(){var i=new Date,n=i.getDate(),t=i.getMonth()+1,r=i.getFullYear();return n<10&&(n="0"+n),t<10&&(t="0"+t),n+"/"+t+"/"+r}return function(i){var e,u,r,f;return i?(e=i.replace(/\//g,"").replace("(","").replace(")","").replace("Date","").replace("+0700","").replace("-0000",""),i.indexOf("Date")>-1?(r=new Date(+e),u=n("date")(r,"dd/MM/yyyy"),f=r.getTime()+r.getTimezoneOffset()*6e4,r=new Date(f+252e5),t()===u?n("date")(r,"HH:mm")+" Hôm nay":n("date")(r,"HH:mm ")+" "+n("date")(r,"dd/MM/yyyy")):(u=n("date")(new Date(e),"dd/MM/yyyy"),t()===u?"Hôm nay":(f=u.getTime()+u.getTimezoneOffset()*6e4,r=new Date(f+252e5),n("date")(r,"dd/MM/yyyy")))):""}});app.filter("dateFormat",function(n){return function(t,i){if(!t)return"";var r=t.replace(/\//g,"").replace("(","").replace(")","").replace("Date","").replace("+0700","").replace("-0000",""),u=new Date(+r);return n("date")(u,i)}});app.filter("sumTotal",function(){return function(n,t){var i=n instanceof Array?n.length:0,r;if(typeof t=="undefined"||i===0)return i;if(isNaN(n[0][t]))throw"filter total can count only numeric values";else{for(r=0;i--;)r+=parseFloat(n[i][t]);return r}}});app.filter("totalSumPriceQty",function(){return function(n,t,i){if(angular.isUndefined(n)||angular.isUndefined(t)||angular.isUndefined(i))return 0;var r=0;return angular.forEach(n,function(n){r=r+parseFloat(n[t],10)*parseFloat(n[i],10)}),r}});app.filter("totalWithOperation",function(){return function(n,t,i,r){if(angular.isUndefined(n)||angular.isUndefined(t)||angular.isUndefined(i)||angular.isUndefined(r))return 0;var u=0;return angular.forEach(n,function(n){u+=parseFloat(eval(n[t]+r+n[i]))}),u}});app.filter("Contains",function(){return function(n,t){return n.indexOf(t)!=-1}});app.filter("IndexOf",function(){return function(n,t){return n?n.indexOf(t)!=-1:!1}});callbackExec=function(){};$POSloading={};$(function(){var t,n;window.location.href.indexOf("Account/Login")==-1&&(t=setInterval(RefreshSession,3e5));$("#modelLoading").modal({show:!1,keyboard:!1});$POSloading.show=function(){$("#modelLoading").modal("show")};$POSloading.hide=function(){$("#modelLoading").modal("hide")};$(".dynamicTable").length>0&&$(".dynamicTable").dataTable({sPaginationType:"bootstrap",sDom:"<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span6'i><'span6'p>>",oLanguage:{sLengthMenu:"_MENU_ số dòng mỗi trang"}});$("input[name*='typeprice_']").click(function(){uniqueCheckRadio(this)});$("form#frmSearchDoPrice").submit(function(){var n=$(this).find(".seachInput");return n.val()==""?(alert("Vui lòng nhập mã sản phẩm hoặc tên sản phẩm cần tiềm kiếm"),n.focus(),!1):!0});$("#btnSubmitNewPermission").click(function(){var n=$("#frmAddPermission");return $("#idPermission").val()==""?(alert("Chưa nhập hoặc nhập sai mã quyền"),$("#idPermission").focus(),!1):$("#namePermission").val()==""?(alert("Chưa nhập tên quyền"),$("#namePermission").focus(),!1):($.post("/Permission/GetPermissionById",n.serializeArray()).done(function(t){if(t.perId!="")return alert("Mã quyền đã tồn tại, vui lòng chọn mã quyền khác"),$("#idPermission").focus(),!1;n.submit()}).fail(function(){return alert("Lỗi không thể lưu thông tin"),!1}),!1)});$(".cmddel_special_price").click(function(){return fdelFromAreaPrice(this)});$("a.cmdadnew_special_price").click(function(){var t=$("#templateFrom").html(),i=$(this).attr("data-product"),r=$(this).attr("data-pricearea"),u=$("#"+$(this).attr("rel")),n="frm_"+Math.round((new Date).getTime()+Math.random()*100),f=$("<form action='/Products/Special' method='post'><\/form>").addClass("frmajaxload").attr({id:n,onSubmit:"return onsubmitform(this)"}).append(t);u.after(f);$("#"+n+" a.cmddel_special_price").attr({rel:n,onclick:"fdelFromAreaPrice(this)"});$("#"+n+" .row2 input[type='radio']").attr("name","typeprice_"+n);$("#"+n+" input[data-id='tempradio1']").attr("id","a_"+n).click(function(){uniqueCheckRadio(this)});$("#"+n+" label[data-id='tempradio1']").attr("for","a_"+n);$("#"+n+" input[data-id='tempradio2']").attr("id","b_"+n).click(function(){uniqueCheckRadio(this)});$("#"+n+" label[data-id='tempradio2']").attr("for","b_"+n);$("#"+n+" input[data-id='tempradio3']").attr("id","c_"+n).click(function(){uniqueCheckRadio(this)});$("#"+n+" label[data-id='tempradio3']").attr("for","c_"+n);$("#"+n+" input.timepicker_load").timepicker({stepMinute:5});$("#"+n+" input.pricespecial_load").number(!0,0);$("#"+n+" input[name='htypeprice']").val("typeprice_"+n);$("#"+n+" input[name='hProductID']").val(i);$("#"+n+" input[name='hAreaID']").val(r);SetDatePicker($("#"+n+" input.datepicker_load"))});$("form.frmajaxload").submit(function(){return onsubmitform(this)});SetDatePicker($(".datepicker"));$(".timepicker").timepicker({timeFormat:"HH:mm",stepMinute:5});$('input[name="PROFITPERCENTAGE"]').number(!0,2);$("input.priceinput").number(!0,0);$("#btn_EditInputVoucher").click(function(){return $("#btn_AcceptInputVoucher").hide(),$("#btn_SaveInputVoucher").show(),$("#btn_CacelEditInputVoucher").show(),$(".hidden-col").show(),$(".stt-col").hide(),$(this).remove(),$(".text_editable").removeAttr("disabled"),$("#CustomerTax").keyup(function(n){var t=$("#CustomerName"),i=$("#CustomerAddress"),r=$("#CustomerId");t.text("");i.text("");r.val("");n.keyCode==13&&$(this).blur()}).focusout(function(){loadCustomer($(this))}),!1});$("#btn_EditInputAcceptVoucher").click(function(){return $("#btn_AcceptInputVoucher").hide(),$("#btn_AcceptStockTransfer").hide(),$("#btn_SaveInputAcceptVoucher").show(),$("#btn_CacelEditInputAcceptVoucher").show(),$(this).remove(),$(".text_editaccept").removeAttr("disabled"),!1});$("td.button-new-rowdetail").click(function(){var n=$("table tr#rowTemplate:first").clone();n.removeAttr("id");n.find("td.button-delete-rowdetail").click(function(){delTableRow($(this))});n.find('input[name="ProductID"]').keyup(function(n){n.keyCode==13?$(this).parent().parent().find('input[name="Quantity"]').focus():($(this).parent().parent().find('span[data-field="ProductName"]').text(""),$(this).parent().parent().find('span[data-field="UnitName"]').text(""),$(this).parent().parent().find('input[name="Quantity"]').val(0),$(this).parent().parent().find('span[data-field="Price"]').text(""),$(this).parent().parent().find('input[name="ToMoney"]').val(0),$(this).parent().parent().find('input[name="Discount"]').val(0))}).focusout(function(){loadProduct($(this))});n.find('select[name="VAT"]').change(function(){$('input[name="VAT"]').val($(this).val());updateSumMoneyVoucher()}).val($('select[name="VATInput"]').val());n.find('input[name="Quantity"], input[name="InQuantity"], input[name="OutQuantity"]').keyup(function(n){n.keyCode==13&&$(this).parent().parent().find('input[name="ToMoney"]').focus().select()}).focusout(function(){updateTotalMoney($(this))}).autoNumeric("init",{mDec:3,vMin:0,vMax:999999});n.find('input[name="ToMoney"]').focusout(function(){updateTotalMoney($(this))}).keyup(function(n){n.keyCode==13&&$(this).parent().parent().find('input[name="Discount"]').focus().select()}).autoNumeric("init",{mDec:0,vMin:0,vMax:9999999999});n.find('input[name="Discount"]').focusout(function(){parseInt($(this).autoNumeric("get"))>parseInt($(this).parent().parent().find('input[name="ToMoney"]').autoNumeric("get"))&&(alert("Tiền chiết khấu theo sản phẩm phải nhỏ hơn hoặc bằng thành tiền sản phẩm."),$(this).val(0),setTimeout(function(){$(this).focus()},10));updateTotalDiscount()}).keyup(function(n){n.keyCode==13&&$(this).blur()}).autoNumeric("init",{mDec:0,vMin:0});$("#listRowDetail").append(n)});$(".button-delete-rowdetail").click(function(){delTableRow($(this))});n="";$('input[name="ProductID"]').keydown(function(){n=$(this).val()});$('input[name="ProductID"]').keyup(function(t){var i=$(this).parent().parent();t.keyCode==13?i.find('input[name="Quantity"]').focus():n!=$(this).val()&&(i.find('span[data-field="ProductName"]').text(""),i.find('span[data-field="UnitName"]').text(""),i.find('input[name="Quantity"]').val(0),i.find('span[data-field="Price"]').text(""),i.find('input[name="ToMoney"]').val(0),i.find('input[name="Discount"]').val(0),i.find('input[name="action"]').val(2),updateTotalMoney(),updateTotalDiscount())}).focusout(function(){loadProduct($(this))});$('input[name="Quantity"]').keyup(function(n){n.keyCode==13&&$(this).parent().parent().find('input[name="ToMoney"]').focus().select()}).focusout(function(){$(this).parent().parent().find('input[name="action"]').val(2);updateTotalMoney($(this))});$('input[name="ToMoney"]').focusout(function(){$(this).parent().parent().find('input[name="action"]').val(2);updateTotalMoney($(this))}).keyup(function(n){n.keyCode==13&&$(this).parent().parent().find('input[name="Discount"]').focus().select()});$('input[name="Discount"]').focusout(function(){parseInt($(this).autoNumeric("get"))>parseInt($(this).parent().parent().find('input[name="ToMoney"]').autoNumeric("get"))&&(alert("Tiền chiết khấu theo sản phẩm phải nhỏ hơn hoặc bằng thành tiền sản phẩm."),$(this).val(0),setTimeout(function(){$(this).focus()},10));$(this).parent().parent().find('input[name="action"]').val(2);updateTotalDiscount()}).keyup(function(n){n.keyCode==13&&$(this).blur()});$("#VoucherDiscount").keyup(function(n){n.keyCode==13&&$(this).blur()}).focusout(function(){updateSumMoneyVoucher()});$("select[name='VATInput']").change(function(){$('input[name="VAT"]').val($(this).val());updateSumMoneyVoucher()});$("select[name='VAT']").change(function(){$('input[name="VAT"]').val($(this).val());updateSumMoneyVoucher()})});$(function(){function t(t,e,o,s,h){var c,y,l,w,b,p,v,a;(e||(e=i),o||(o=f),s||(s=u),c=document,c.getElementById("modalContainer"))||(y=c.getElementsByTagName("body")[0].appendChild(c.createElement("div")),y.id="modalContainer",y.style.height=c.documentElement.scrollHeight+"px",l=y.appendChild(c.createElement("div")),l.id="alertBox",c.all&&!window.opera&&(l.style.top=document.documentElement.scrollTop+"px"),l.style.left=(c.documentElement.scrollWidth-l.offsetWidth)/2+"px",l.style.visiblity="visible",w=l.appendChild(c.createElement("h1")),w.appendChild(c.createTextNode(e)),b=l.appendChild(c.createElement("p")),b.innerHTML=t,h?(p=l.appendChild(c.createElement("div")),p.className="btnGroup",v=p.appendChild(c.createElement("button")),v.id="cancelBtnAlert",v.className="btn btn-light",v.appendChild(c.createTextNode(o)),v.href="#",v.onclick=function(){return n(),h(!1),!1},a=p.appendChild(c.createElement("button")),a.className="btn btn-success",a.appendChild(c.createTextNode(s)),a.href="#",a.onclick=function(){return n(),h(!0),!1}):(a=l.appendChild(c.createElement("button")),a.id="closeBtnAlert",a.className="btn btn-success",a.appendChild(c.createTextNode(r)),a.href="#",a.onclick=function(){return n(),!1}),l.style.display="block")}var i="Thông báo",r="Đồng ý",u="Đồng ý",f="Bỏ qua",n=function(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("modalContainer"))};document.getElementById&&(window.alert=function(n){t(n,null)},window.confirm=function(n,i,r,u,f){t(n,i,r,u,f)})});app.directive("clearabletextbox",function(n){return{restrict:"E",scope:{iconposition:"@",textboxtype:"@",textboxstyle:"@",textboxplaceholder:"@",valuemodel:"=",textboxmaxlength:"@",resultchange:"&",resultchangedelay:"@",resultchangeminlength:"@",submitonenter:"&",cleartext:"&",blur:"&",disable:"=",textalignment:"@",isnumberformat:"=",islargetext:"=",isclickclear:"=",disablenumber:"=",allowonlynumber:"=",nfocus:"=",isinteger:"=",focustextbox:"="},transclude:!0,templateUrl:"/Directives/ClearableTextBox.html?v=2",link:function(t,i){var r=null,u=function(){var u,o,s,r,l,h;if(t.textboxmodel=t.textboxmodel.trim(),t.textboxmodel.length>1){while(t.textboxmodel.charAt(0)=="0"&&t.textboxmodel.charAt(1)!=".")t.textboxmodel=t.textboxmodel.substr(1);u=t.textboxmodel.replace(/[^\d.\','] /g,"");o=u.indexOf(".");o>=0&&(u=u.slice(0,o+3));var c=u.split("."),n=c[0],e=c[1];if(n=n.replace(/[^\d]/g,""),n.length>3)for(s=Math.floor(n.length/3);s>0;)r=n.indexOf(","),r<0&&(r=n.length),r-3>0&&(n=n.substr(0,r-3)+","+n.substr(r-3)),--s;e=e===undefined?"":"."+e;l=n+e;t.textboxmodel=l;t.modelnotcomma=1e3;try{var a=i[0].children[0].children[0],f=$(a),v=a;f.is(":focus")||f.focus();v.setSelectionRange?(h=f.val().length*2,setTimeout(function(){v.setSelectionRange(h,h)},1)):f.val(f.val());this.scrollTop=999999}catch(y){}}},e=function(){r&&n.cancel(r);(!t.resultchangeminlength||t.textboxmodel&&t.textboxmodel.trim().length>=t.resultchangeminlength)&&(r=n(function(){t.resultchange()},t.resultchangedelay))},f;t.Change=function(){var r,i;t.textboxmodel==null&&(t.textboxmodel="");t.isnumberformat&&(isNaN(parseFloat(t.textboxmodel))?t.textboxmodel="":u());t.isinteger&&(r=t.textboxmodel.replace(/[^0-9]/g,""),t.textboxmodel=t.textboxmodel.replace(",",""),r!=t.textboxmodel?t.textboxmodel="":u());t.resultchangedelay?e():t.resultchange&&n(t.resultchange);i=t.textboxmodel.replace(/[^\d]/g,"");t.valuemodel=isNaN(i)?0:parseFloat(i)};t.KeyPress=function(i){t.submitonenter&&(i.keyCode==13||i.which==13)&&n(t.submitonenter)};t.KeyDown=function(n){(t.isnumberformat||t.textboxtype=="tel")&&(!n.ctrlKey&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=46&&n.keyCode!=13&&n.keyCode!=8&&n.keyCode!=37&&n.keyCode!=39&&n.keyCode!=46&&n.keyCode!=8&&(n.keyCode!=190||t.textboxmodel.indexOf(".")>-1)||n.shiftKey)&&n.preventDefault();t.disablenumber&&n.keyCode>48&&n.keyCode<57&&n.preventDefault();t.textboxmodel&&t.textboxmodel.length==t.textboxmaxlength&&n.keyCode!=46&&n.keyCode!=8&&n.preventDefault()};t.Clear=function(){t.textboxmodel="";t.cleartext&&n(t.cleartext)};t.ClickClear=function(){t.isclickclear&&(t.textboxmodel="",t.valuemodel="")};t.Blur=function(){t.blur&&n(t.blur)};f=function(){t.type=t.isnumberformat&&t.textboxtype!="number"?"tel":t.textboxtype;t.textStyle=t.textboxstyle+";padding-";t.iconStyle="position:absolute; font-size:20px; line-height:35px; height:40px; width:34px; color:black;";t.iconposition=="left"?(t.textStyle=t.textStyle+"left:40px;text-align:right",t.iconStyle=t.iconStyle+"left"):(t.textStyle=t.textStyle+"right:40px;text-align:left",t.iconStyle=t.iconStyle+"right");t.iconStyle=t.iconStyle+":0";t.islargetext&&(t.textStyle=t.textStyle+";font-size:20px");t.maxLength=100;t.nfocus&&(t.focus=t.nfocus);t.textboxmaxlength&&(t.maxLength=t.textboxmaxlength);t.resultchangedelay&&(t.resultchangeminlength=t.resultchangeminlength?parseInt(t.resultchangeminlength):0);t.iconposition||(t.iconposition="right")};f()}}});app.directive("divpage",function(n){return{restrict:"E",scope:{pageclick:"&",pagemodel:"=",totalpage:"@",currentpage:"@"},templateUrl:"/Directives/divPage.html",link:function(t){t.range=new Array(100);t.listPage=[];t.$watch("currentpage",function(n){i(parseInt(n),parseInt(t.totalpage))});t.$watch("totalpage",function(n){i(parseInt(t.currentpage),parseInt(n))});t.pageOnClick=function(i){t.pagemodel=i;n(t.pageclick,50)};var i=function(n,i){var u=[],e=1,o=i,f,r;for(n>3&&(e=n-2,r={},r.page=1,r.text=1,u.push(r)),n>4&&(r={},r.page=n-3,r.text="...",u.push(r)),o=Math.min(n+2,i),f=e;f<=o;f++)r={},r.page=f,r.text=f,u.push(r);n+3<i&&(r={},r.page=n+3,r.text="...",u.push(r));n+2<i&&(r={},r.page=i,r.text=i,u.push(r));t.listPage=u},r=function(){};r()}}});app.directive("moDateInput",function(n){return{require:"^ngModel",restrict:"A",link:function(t,i,r,u){var e=n.moment,f=r.moMediumDate;r.$observe("moDateInput",function(n){f!=n&&u.$modelValue&&(f=n,u.$modelValue=new Date(u.$setViewValue))});u.$formatters.unshift(function(n){if(t=t,!f||!n)return"";return e(n).format(f)});u.$parsers.unshift(function(n){t=t;var i=e(n,f);return i&&i.isValid()&&i.year()>1950?i.toDate():""})}}});