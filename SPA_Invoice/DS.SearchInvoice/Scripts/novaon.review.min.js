(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","jquery.ui.widget"],n):n(window.jQuery)})(function(n){"use strict";n.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);n.support.xhrFormDataFileUpload=!!window.FormData;n.widget("blueimp.fileupload",{options:{dropZone:n(document),pasteZone:n(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,formData:function(n){return n.serializeArray()},add:function(t,i){(i.autoUpload||i.autoUpload!==!1&&(n(this).data("blueimp-fileupload")||n(this).data("fileupload")).options.autoUpload)&&i.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date;this.loaded=0;this.bitrate=0;this.getBitrate=function(n,t,i){var r=n-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=n),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&n.support.xhrFileUpload||n.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return typeof t.formData=="function"?t.formData(t.form):n.isArray(t.formData)?t.formData:t.formData?(i=[],n.each(t.formData,function(n,t){i.push({name:n,value:t})}),i):[]},_getTotal:function(t){var i=0;return n.each(t,function(n,t){i+=t.size||1}),i},_initProgressObject:function(n){n._progress={loaded:0,total:0,bitrate:0}},_onProgress:function(n,t){if(n.lengthComputable){var i=+new Date,r;if(t._time&&t.progressInterval&&i-t._time<t.progressInterval&&n.loaded!==n.total)return;t._time=i;r=Math.floor(n.loaded/n.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0);this._progress.loaded+=r-t._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,t.bitrateInterval);t._progress.loaded=t.loaded=r;t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(i,r,t.bitrateInterval);this._trigger("progress",n,t);this._trigger("progressall",n,this._progress)}},_initProgressListener:function(t){var r=this,i=t.xhr?t.xhr():n.ajaxSettings.xhr();i.upload&&(n(i.upload).bind("progress",function(n){var i=n.originalEvent;n.lengthComputable=i.lengthComputable;n.loaded=i.loaded;n.total=i.total;r._onProgress(n,t)}),t.xhr=function(){return i})},_initXHRData:function(t){var i,r=t.files[0],f=t.multipart||!n.support.xhrFileUpload,u=t.paramName[0];t.headers=t.headers||{};t.contentRange&&(t.headers["Content-Range"]=t.contentRange);f?n.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:u,value:t.blob}):n.each(t.files,function(n,r){i.push({name:t.paramName[n]||u,value:r})})):(t.formData instanceof FormData?i=t.formData:(i=new FormData,n.each(this._getFormData(t),function(n,t){i.append(t.name,t.value)})),t.blob?(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"',i.append(u,t.blob,r.name)):n.each(t.files,function(n,r){(window.Blob&&r instanceof Blob||window.File&&r instanceof File)&&i.append(t.paramName[n]||u,r,r.name)})),t.data=i):(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"',t.contentType=r.type,t.data=t.blob||r);t.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||"");t.formData=this._getFormData(t);t.redirect&&n("<a><\/a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(n){this._isXHRUpload(n)?(this._chunkedUpload(n,!0)||(n.data||this._initXHRData(n),this._initProgressListener(n)),n.postMessage&&(n.dataType="postmessage "+(n.dataType||""))):this._initIframeSettings(n,"iframe")},_getParamName:function(t){var r=n(t.fileInput),i=t.paramName;return i?n.isArray(i)||(i=[i]):(i=[],r.each(function(){for(var t=n(this),u=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(u),r-=1}),i.length||(i=[r.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=n(t.fileInput.prop("form")),t.form.length||(t.form=n(this.options.fileInput.prop("form"))));t.paramName=this._getParamName(t);t.url||(t.url=t.form.prop("action")||location.href);t.type=(t.type||t.form.prop("method")||"").toUpperCase();t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST");t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=n.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(n){return n.state?n.state():n.isResolved()?"resolved":n.isRejected()?"rejected":"pending"},_enhancePromise:function(n){return n.success=n.done,n.error=n.fail,n.complete=n.always,n},_getXHRPromise:function(t,i,r){var u=n.Deferred(),f=u.promise();return i=i||this.options.context||f,t===!0?u.resolveWith(i,r):t===!1&&u.rejectWith(i,r),f.abort=u.promise,this._enhancePromise(f)},_addConvenienceMethods:function(n,t){var i=this;t.submit=function(){return this.state()!=="pending"&&(t.jqXHR=this.jqXHR=i._trigger("submit",n,this)!==!1&&i._onSend(n,this)),this.jqXHR||i._getXHRPromise()};t.abort=function(){return this.jqXHR?this.jqXHR.abort():this._getXHRPromise()};t.state=function(){if(this.jqXHR)return i._getDeferredState(this.jqXHR)};t.progress=function(){return this._progress}},_getUploadedBytes:function(n){var i=n.getResponseHeader("Range"),t=i&&i.split("-"),r=t&&t.length>1&&parseInt(t[1],10);return r&&r+1},_chunkedUpload:function(t,i){var u=this,f=t.files[0],e=f.size,r=t.uploadedBytes=t.uploadedBytes||0,c=t.maxChunkSize||e,l=f.slice||f.webkitSlice||f.mozSlice,o=n.Deferred(),s=o.promise(),a,h;return!(this._isXHRUpload(t)&&l&&(r||c<e))||t.data?!1:i?!0:r>=e?(f.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,t.context,[null,"error",f.error])):(h=function(){var i=n.extend({},t),s=i._progress.loaded;i.blob=l.call(f,r,r+c,f.type);i.chunkSize=i.blob.size;i.contentRange="bytes "+r+"-"+(r+i.chunkSize-1)+"/"+e;u._initXHRData(i);u._initProgressListener(i);a=(u._trigger("chunksend",null,i)!==!1&&n.ajax(i)||u._getXHRPromise(!1,i.context)).done(function(f,c,l){r=u._getUploadedBytes(l)||r+i.chunkSize;i._progress.loaded===s&&u._onProgress(n.Event("progress",{lengthComputable:!0,loaded:r-i.uploadedBytes,total:r-i.uploadedBytes}),i);t.uploadedBytes=i.uploadedBytes=r;i.result=f;i.textStatus=c;i.jqXHR=l;u._trigger("chunkdone",null,i);u._trigger("chunkalways",null,i);r<e?h():o.resolveWith(i.context,[f,c,l])}).fail(function(n,t,r){i.jqXHR=n;i.textStatus=t;i.errorThrown=r;u._trigger("chunkfail",null,i);u._trigger("chunkalways",null,i);o.rejectWith(i.context,[n,t,r])})},this._enhancePromise(s),s.abort=function(){return a.abort()},h(),s)},_beforeSend:function(n,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);t._progress||(t._progress={});t._progress.loaded=t.loaded=t.uploadedBytes||0;t._progress.total=t.total=this._getTotal(t.files)||1;t._progress.bitrate=t.bitrate=0;this._active+=1;this._progress.loaded+=t.loaded;this._progress.total+=t.total},_onDone:function(t,i,r,u){var f=u._progress.total;u._progress.loaded<f&&this._onProgress(n.Event("progress",{lengthComputable:!0,loaded:f,total:f}),u);u.result=t;u.textStatus=i;u.jqXHR=r;this._trigger("done",null,u)},_onFail:function(n,t,i,r){r.jqXHR=n;r.textStatus=t;r.errorThrown=i;this._trigger("fail",null,r);r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total)},_onAlways:function(n,t,i,r){this._active-=1;this._trigger("always",null,r);this._active===0&&this._trigger("stop")},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var r=this,f,s,e,h,u=r._getAJAXSettings(i),o=function(){return r._sending+=1,u._bitrateTimer=new r._BitrateTimer,f=f||((s||r._trigger("send",t,u)===!1)&&r._getXHRPromise(!1,u.context,s)||r._chunkedUpload(u)||n.ajax(u)).done(function(n,t,i){r._onDone(n,t,i,u)}).fail(function(n,t,i){r._onFail(n,t,i,u)}).always(function(n,t,i){if(r._sending-=1,r._onAlways(n,t,i,u),u.limitConcurrentUploads&&u.limitConcurrentUploads>r._sending)for(var f=r._slots.shift();f;){if(r._getDeferredState(f)==="pending"){f.resolve();break}f=r._slots.shift()}})};return(this._beforeSend(t,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)?(this.options.limitConcurrentUploads>1?(e=n.Deferred(),this._slots.push(e),h=e.pipe(o)):h=this._sequence=this._sequence.pipe(o,o),h.abort=function(){return(s=[undefined,"abort","abort"],!f)?(e&&e.rejectWith(u.context,s),o()):f.abort()},this._enhancePromise(h)):o()},_onAdd:function(t,i){var c=this,l=!0,u=n.extend({},this.options,i),f=u.limitMultiFileUploads,s=this._getParamName(u),e,h,o,r;if((u.singleFileUploads||f)&&this._isXHRUpload(u))if(!u.singleFileUploads&&f)for(o=[],e=[],r=0;r<i.files.length;r+=f)o.push(i.files.slice(r,r+f)),h=s.slice(r,r+f),h.length||(h=s),e.push(h);else e=s;else o=[i.files],e=[s];return i.originalFiles=i.files,n.each(o||i.files,function(r,u){var f=n.extend({},i);return f.files=o?u:[u],f.paramName=e[r],c._initProgressObject(f),c._addConvenienceMethods(t,f),l=c._trigger("add",t,f)}),l},_replaceFileInput:function(t){var i=t.clone(!0);n("<form><\/form>").append(i)[0].reset();t.after(i).detach();n.cleanData(t.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(n,r){return r===t[0]?i[0]:r});t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var e=this,r=n.Deferred(),u=function(n){n&&!n.entry&&(n.entry=t);r.resolve([n])},f;return i=i||"",t.isFile?t._file?(t._file.relativePath=i,r.resolve(t._file)):t.file(function(n){n.relativePath=i;r.resolve(n)},u):t.isDirectory?(f=t.createReader(),f.readEntries(function(n){e._handleFileTreeEntries(n,i+t.name+"/").done(function(n){r.resolve(n)}).fail(u)},u)):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var r=this;return n.when.apply(n,n.map(t,function(n){return r._handleFileTreeEntry(n,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(n.map(i,function(n){var t;return n.webkitGetAsEntry?(t=n.webkitGetAsEntry(),t&&(t._file=n.getAsFile()),t):n.getAsEntry()})):n.Deferred().resolve(n.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=n(t);var r=t.prop("webkitEntries")||t.prop("entries"),i,u;if(r&&r.length)return this._handleFileTreeEntries(r);if(i=n.makeArray(t.prop("files")),i.length)i[0].name===undefined&&i[0].fileName&&n.each(i,function(n,t){t.name=t.fileName;t.size=t.fileSize});else{if(u=t.prop("value"),!u)return n.Deferred().resolve([]).promise();i=[{name:u.replace(/^.*\\/,"")}]}return n.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return!(t instanceof n)||t.length===1?this._getSingleFileInputFiles(t):n.when.apply(n,n.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(t){var r=this,i={fileInput:n(t.target),form:n(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(n){i.files=n;r.options.replaceFileInput&&r._replaceFileInput(i.fileInput);r._trigger("change",t,i)!==!1&&r._onAdd(t,i)})},_onPaste:function(t){var r=t.originalEvent.clipboardData,u=r&&r.items||[],i={files:[]};return n.each(u,function(n,t){var r=t.getAsFile&&t.getAsFile();r&&i.files.push(r)}),this._trigger("paste",t,i)===!1||this._onAdd(t,i)===!1?!1:void 0},_onDrop:function(n){var r=this,t=n.dataTransfer=n.originalEvent.dataTransfer,i={};t&&t.files&&t.files.length&&n.preventDefault();this._getDroppedFiles(t).always(function(t){i.files=t;r._trigger("drop",n,i)!==!1&&r._onAdd(n,i)})},_onDragOver:function(t){var i=t.dataTransfer=t.originalEvent.dataTransfer;if(this._trigger("dragover",t)===!1)return!1;i&&n.inArray("Files",i.types)!==-1&&(i.dropEffect="copy",t.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste}));this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(t,i){var r=n.inArray(t,this._refreshOptionsList)!==-1;r&&this._destroyEventHandlers();this._super(t,i);r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof n||(t.fileInput=n(t.fileInput));t.dropZone instanceof n||(t.dropZone=n(t.dropZone));t.pasteZone instanceof n||(t.pasteZone=n(t.pasteZone))},_create:function(){var t=this.options;n.extend(t,n(this.element[0].cloneNode(!1)).data());this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(n){t.files=n;i._onAdd(null,t)}):(t.files=n.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var e=this,i=n.Deferred(),r=i.promise(),u,f;return r.abort=function(){return(f=!0,u)?u.abort():(i.reject(null,"abort","abort"),r)},this._getFileInputFiles(t.fileInput).always(function(n){f||(t.files=n,u=e._onSend(null,t).then(function(n,t,r){i.resolve(n,t,r)},function(n,t,r){i.reject(n,t,r)}))}),this._enhancePromise(r)}if(t.files=n.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(n){"use strict";function f(n,i){var r=document,o,u,v,a,e,f;if(!r.getElementById("modalContainer")){o=r.getElementsByTagName("body")[0].appendChild(r.createElement("div"));o.id="modalContainer";o.style.height=r.documentElement.scrollHeight+"px";u=o.appendChild(r.createElement("div"));u.id="alertBox";r.all&&!window.opera&&(u.style.top=document.documentElement.scrollTop+"px");u.style.left=(r.documentElement.scrollWidth-u.offsetWidth)/2+"px";u.style.visiblity="visible";v=u.appendChild(r.createElement("h1"));v.appendChild(r.createTextNode(s));var y=u.appendChild(r.createElement("p")),p=new RegExp("\n","g");y.innerHTML=n;i?(a=u.appendChild(r.createElement("div")),a.className="btnGroup",e=a.appendChild(r.createElement("button")),e.id="cancelBtnAlert",e.className="btn btn-default",e.appendChild(r.createTextNode(l)),e.href="#",e.onclick=function(){return t(),i(!1),!1},f=a.appendChild(r.createElement("button")),f.className="btn btn-success",f.appendChild(r.createTextNode(c)),f.href="#",f.onclick=function(){return t(),i(!0),!1}):(f=u.appendChild(r.createElement("button")),f.id="closeBtnAlert",f.className="btn btn-success",f.appendChild(r.createTextNode(h)),f.href="#",f.onclick=function(){return t(),!1});u.style.display="block"}}var s="Thông báo",h="Ok",c="Đồng ý",l="Bỏ qua",a=window.location.href,r=function(){var u=n('[name="lb_search_invoice"]:checked').attr("id")==="lb_search_by_symbol"?!0:!1,t,i,r;if(u){if(t=n('[name="keyword"]').val(),t==null||t.trim()=="")return alert("Mã tra cứu không được để trống. <br>Vui lòng nhập mã tra cứu."),!1;i=n(".toggle-show");i.toggleClass("d-none");r=JSON.stringify({id:t});n.ajax({url:appUri+"/tracuu/search_by_code",type:"POST",headers:{"X-Requested-With":"Novaon-DS","Token-String":"","Device-UUID":""},timeout:6e4,cache:!0,crossDomain:!0,contentType:"application/json; charset=utf-8;",dataType:"json",data:r,processData:!0,async:!0,tryCount:0,retryLimit:3,success:function(n){if(n&&n.rs&&n.msg){var t=n.msg;o(t)}else alert("Mã tra cứu không đúng. Vui lòng xem lại. <br><br>Mã tra cứu được tạo ra tự động bởi hệ thống OnFinance.asia của NOVAON và được ghi dưới mỗi hóa đơn điện tử.");i.toggleClass("d-none")},error:function(){i.toggleClass("d-none")}})}else searchByFile()},v=function(n){for(var i=[],t,u=n.slice(n.indexOf("?")+1).split("&"),r=0;r<u.length;r++)t=u[r].split("="),i.push(t[0]),i[t[0]]=t[1];return i},u=v(a),t,i;u.referencecode!=null&&(n('[name="keyword"]').val(u.referencecode),r());t=function(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("modalContainer"))};document.getElementById&&(window.alert=function(n){f(n,null)},window.confirm=function(n,t){f(n,t)});n(".navbar-xbootstrap, .cover-bg").click(function(){n(".nav-xbootstrap").toggleClass("visible");n(".cover-bg").toggle()});n('[name="lb_search_invoice"]').change(function(){var t=n(".frm-search-text"),i=n(".frm-search-file");n('[name="keyword"], [name="file-xml"]').val("");n('[name="lb_search_invoice"]:checked').attr("id")==="lb_search_by_symbol"?(t.show(),i.hide()):(t.hide(),i.show())});n(".frm-search-file").click(function(){n("#input_select_file").trigger("click")});var e=null,o=function(t){console.log(t);e=t;t.SIGNEDLINK?(n("#invoice_id").val(t.ID),n("#popupViewInvoice").dialog({modal:!0,resizable:!1,open:function(){var i,u;n("#frViewFileInvoice").attr("src",t.SIGNEDLINK);n(this).dialog("option","title","Hóa đơn của: "+t.CUSNAME);t.INVOICESTATUS===2&&t.INVOICETYPE!=4&&t.INVOICETYPE!=3?(i=n("#btnConvertInvoice"),(i==undefined||i.length==0)&&(u=n('<button id ="btnConvertInvoice" class="btn btn-warning convert-invoice-paper" role="button" aria-haspopup="true" aria-expanded="false">Chuyển thành hóa đơn giấy<\/button>'),u.appendTo(n('[aria-describedby="popupViewInvoice"] .ui-dialog-titlebar')),n("#btnConvertInvoice").click(function(n){p();y(n)}))):n("#btnConvertInvoice").remove();n("#downloadFileInvoice").remove();var f=n('<div class="dropdown" id="downloadFileInvoice" />').appendTo(n('[aria-describedby="popupViewInvoice"] .ui-dialog-titlebar')),e=n('<button class="btn btn-success dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tải file<\/button>').appendTo(f),r=n('<div class="dropdown-menu" aria-labelledby="dropdownMenuLink" />').appendTo(f),o=n('<a class="dropdown-item download-link-template-pdf">Tải file PDF<\/a>').attr({target:"_blank",href:appUri+"/tracuu/downloadfile?link="+t.PREVIEWLINK}).appendTo(r),s=n('<a class="dropdown-item">Tải file XML<\/a>').attr({target:"_blank",href:appUri+"/tracuu/downloadfile?link="+t.SIGNEDXML}).appendTo(r),h=n('<a class="dropdown-item">Tải chứng chỉ<\/a>').attr({target:"_blank",href:appUri+"/tracuu/downloadfile?link="+t.CERTIFICATELINK}).appendTo(r)}})):alert("Không tìm thấy hóa đơn bạn cần xem. <br>Vui lòng hỏi lại bên bán để xác nhận hóa đơn đã được ký hay chưa.")},y=function(n){n.stopPropagation&&(n.stopPropagation(),n.preventDefault())},p=function(){n("#txtConverter").val("");n("#txtConverter").focus();n("#btnContine").show();n("#btnCancel").show();n("#popupContentInvoicePaper").dialog({modal:!0,resizable:!1,width:380,height:184,open:function(){n(this).dialog("option","title","CHUYỂN THÀNH HÓA ĐƠN GIẤY")}})};n("#btnCancel").click(function(){n("#popupContentInvoicePaper").dialog("close");n("#txtConverter").removeClass("required");n(".text-required").hide()});n("#btnContine").click(function(){var t=n("#txtConverter").val();t==""?(n("#popupContentInvoicePaper").css("height","196px"),n("#txtConverter").addClass("required"),n(".text-required").show(),n("#txtConverter").focus()):i()});n("#popupContentInvoicePaper").bind("keypress",function(t){if(t.keyCode==13){var r=n("#txtConverter").val();r==""?(n("#txtConverter").addClass("required"),n(".text-required").show(),n("#txtConverter").focus()):i()}});i=function(){var t,i;n("#btnContine").hide();n("#btnCancel").hide();t=n(".toggle-show");t.toggleClass("d-none");i=JSON.stringify({id:n("#invoice_id").val(),fullName:n("#txtConverter").val(),invoice:e});n.ajax({url:appUri+"/tracuu/convert_invoice",type:"POST",headers:{"X-Requested-With":"Novaon-DS","Token-String":"","Device-UUID":""},timeout:6e4,cache:!0,crossDomain:!0,contentType:"application/json; charset=utf-8;",dataType:"json",data:i,processData:!0,async:!0,tryCount:0,retryLimit:3,success:function(i){i?i.rs?(n("#btnConvertInvoice").remove(),n(".download-link-template-pdf").attr("href",appUri+"/tracuu/downloadfile?link="+i.linkDown),n("#frViewFileInvoice").attr("src",i.linkView),alert("Chuyển đổi thành công!")):(alert(i.msg),n("#btnContine").show(),n("#btnCancel").show()):(alert("Không thể chuyển đồi sang hóa đơn giấy, Vui lòng thử lại sau."),n("#btnContine").show(),n("#btnCancel").show());t.toggleClass("d-none");n("#popupContentInvoicePaper").dialog("close")},error:function(){alert("Không thể chuyển đồi sang hóa đơn giấy, Vui lòng thử lại sau.");t.toggleClass("d-none");n("#btnContine").show();n("#btnCancel").show()}})};n("#txtConverter").change(function(){var t=n("#txtConverter").val();t==""?(n("#txtConverter").addClass("required"),n(".text-required").show()):(n("#txtConverter").removeClass("required"),n(".text-required").hide())});n("#txtConverter").on("keypress",function(){n("#txtConverter").removeClass("required");n(".text-required").hide()});n("#cmd_search").click(function(){r()});n("#input_select_file").fileupload({autoUpload:!1,add:function(t,i){var r,u;i.files[0].type.match("text/xml")&&(n('[name="file-xml"]').val(i.files[0].name),r=n(".toggle-show"),r.toggleClass("d-none"),u=new FormData,u.append("file0",i.files[0]),n.ajax({type:"POST",url:appUri+"/tracuu/search_by_file",contentType:!1,processData:!1,data:u,success:function(n){if(n&&n.rs&&n.msg){var t=n.msg;o(t)}else alert(n.msg);r.toggleClass("d-none")},error:function(){r.toggleClass("d-none");alert("Không thể đọc file xml.")}}))}})}(jQuery);