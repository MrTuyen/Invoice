function validatePhone(n){return/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(n)?!0:!1}function validateEmail(n){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)}function attachSignin(n){auth2.attachClickHandler(n,{},function(n){var i=n.getBasicProfile(),t={};t.ID=i.getId();t.Name=i.getName();t.Avarta=i.getImageUrl();t.Email=i.getEmail();t.utmsource="google";showLoading();$.post("/user-account/quick-login",t,function(n){n.User!=null?validatePhone(n.User.PHONENUMBER)?(toastr.success("Đăng nhập thành công!",{timeOut:"2000"}),sessionStorage.setItem("userNameSS",n.User.USERNAME),window.location.href="/#!/tong-quan"):window.location.href="/user-account/phonenumber/?email="+t.Email:window.location.href="/user-account/phonenumber/?email="+t.Email;hideLoading()})},function(){hideLoading()})}function ResetData(){$("input#username","input#password").val("")}function LoginRequest(){if(!$("input#username").val())return toastr.warning("Vui lòng nhập vào email hoặc số điện thoại"),$("input#username").focus(),!1;if(!$("input#password").val())return toastr.warning("Vui lòng nhập vào mật khẩu"),$("input#password").focus(),!1;showLoading();var n=window.location.pathname;$.ajax({type:"POST",url:n+"/",data:{username:$("input#username").val(),password:$("input#password").val()},dataType:"json",success:function(n){n.rs?(toastr.options={timeOut:"2000"},toastr.success("Đăng nhập thành công!"),sessionStorage.setItem("userNameSS",n.objUser.USERNAME),window.location.href="/#!/tong-quan"):(toastr.warning(n.msg),hideLoading())},error:function(){hideLoading()}})}function RegisterRequest(){showLoading();var n=window.location.pathname;$.ajax({type:"POST",url:n+"/",data:{phonenumber:$("input#phonenumber").val(),email:$("input#email").val(),password:$("input#password").val()},dataType:"json",success:function(n){n.rs?window.location.href="/#!/tong-quan":(n.msg?toastr.warning(n.msg):toastr.warning("Thông tin đăng nhập không đúng vui lòng kiểm tra lại"),hideLoading())},error:function(){hideLoading()}})}function ForgotPasswordRequest(){var n=window.location.pathname;$("input#phone-email").val()==""?toastr.warning("Email hoặc số điện thoại đang để trống!"):validateEmail($("input#phone-email").val())||validatePhone($("input#phone-email").val())?(showLoading(),$.ajax({type:"POST",url:n+"/",data:{username:$("input#phone-email").val()},dataType:"json",success:function(n){n.rs?(localStorage.setItem("username",n.data),hideLoading(),window.location.href="/user-account/resend-email"):(hideLoading(),toastr.info(n.msg))},error:function(){}})):toastr.info("Email hoặc số điện thoại không hợp lệ!")}function UpdatePhoneNumber(){if($("input#phonenumber").val()=="")toastr.warning("Số điện thoại đang để trống!");else if(validatePhone($("input#phonenumber").val())){var n=window.location.pathname;$.ajax({type:"POST",url:n+"/",data:{phonenumber:$("input#phonenumber").val(),email:$("input#login-email").val()},dataType:"json",success:function(n){n.rs?window.location.href="/#!/tong-quan":toastr.warning(n.msg)},error:function(){}})}else toastr.warning("Số điện thoại không đúng định dạng!")}function showLoading(){loadingSvg.show();$("button").attr("disabled","disabled")}function hideLoading(){loadingSvg.hide();$("button").removeAttr("disabled")}gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:"958337842953-4aelsfbirqv0e2e2lk1akdboghlpsr7t.apps.googleusercontent.com",cookiepolicy:"none"});attachSignin(document.getElementById("googleLogin"))});$("#phone-email").keypress(function(n){n.which==13&&(ForgotPasswordRequest(),event.preventDefault())});$("#email-phone").html(localStorage.getItem("username"));var loadingSvg=$(".btn-register img");(function(n){"use strict";function r(t){if(n(t).attr("type")=="email"||n(t).attr("name")=="email"){if(n(t).val().trim().match(/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{1,5}|[0-9]{1,3})(\]?)$/)==null)return!1}else if(n(t).attr("name")=="phonenumber"){if(n(t).val().trim().match(/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im)==null)return!1}else if(n(t).val().trim()=="")return!1}function u(t){n(t).addClass("border-danger")}function f(t){n(t).removeClass("border-danger")}var t,i;n(".input100").each(function(){n(this).on("blur",function(){n(this).val().trim()!=""?n(this).addClass("has-val"):n(this).removeClass("has-val")})});t=n(".validate-input .input100");n(".validate-form").on("onclick",function(){for(var f=!0,i=0;i<t.length;i++)r(t[i])==!1&&(u(t[i]),f=!1);return f||n(".border-danger").first().focus(),f});n(".validate-form .input100").keypress(function(){f(this)});i=0;n(".btn-show-pass").on("click",function(){i==0?(n(this).next("input").attr("type","text"),n(this).find("i").removeClass("zmdi-eye"),n(this).find("i").addClass("zmdi-eye-off"),i=1):(n(this).next("input").attr("type","password"),n(this).find("i").addClass("zmdi-eye"),n(this).find("i").removeClass("zmdi-eye-off"),i=0)});n("input#username").on("touchstart click",function(t){t.preventDefault();var i=t.touches[0];i?n("span.focus-input100").hide():n("span.focus-input100").show()});n("input#password").on("touchstart click",function(t){t.preventDefault();var i=t.touches[0];i?n("span.focus-input100").hide():n("span.focus-input100").show()});n("#btn-login").click(function(){LoginRequest()});n("input#username").keypress(function(t){t.which==13&&(n("input#password").val()!=""?LoginRequest():n("input#password").focus())});n("input#password").keypress(function(n){n.which==13&&LoginRequest()});n("#btn-send-email").click(function(){var t=30,i=!0,r;n("#btn-send-email").attr("disabled","disabled");n("#count").removeClass("display-none");r=function(){i&&(t!=0&&n("#count").html(t),t==0&&(n("#btn-send-email").removeAttr("disabled"),n("#count").addClass("display-none"),i=!1),t--)};setInterval(r,1e3)});n("#phonenumber").keypress(function(n){n.which==13&&(UpdatePhoneNumber(),event.preventDefault())});setTimeout(function(){n("input#username").focus()},100);setTimeout(function(){n("input#phone-email").focus()},100)})(jQuery);