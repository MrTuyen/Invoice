@*Phát hành HĐ lỗi*@
<div ng-show="Tab.ReleaseError">
    <div class="bg-white border mt-2">
        <div class="header-filter px-3 pt-2">
            <div class="btn-group btn-filter">
                <button type="button" class="btn btn-light btn-sm dropdown-toggle" data-toggle="dropdown">
                    <span class="fa fa-filter"></span> Bộ lọc
                </button>
                <div class="dropdown-menu p-3">
                    <form id="frmInvoiceFilterError">
                        <div class="row">
                            <div class="col-6">
                                <p class="mb-1">Trạng thái hoá đơn</p>
                                <select class="form-control form-control-sm ddl-novaon" name="INVOICESTATUS" ng-model="Filter.INVOICESTATUS">
                                    <option value="{{null}}" selected>Tất cả</option>
                                    <option ng-repeat="item in ListInvoiceStatus" value="{{item.INVOICESTATUSID}}">{{item.INVOICESTATUSNAME}}</option>
                                </select>

                                <p class="mb-1 mt-3">Mẫu số</p>
                                <select class="form-control form-control-sm ddl-novaon" ng-model="Filter.FORMCODE">
                                    <option value="" selected>Tất cả</option>
                                    <option ng-repeat="item in ListFormCode" value="{{item.FORMCODE}}">{{item.FORMCODE}}</option>
                                </select>


                                <p class="mb-1 mt-3">Khách hàng</p>
                                <input class="form-control form-control-sm" ng-model="Filter.CUSTOMER" placeholder="Tên doanh nghiệp..." />
                                <p class="mb-1 mt-3">Sắp xếp</p>
                                <select class="form-control form-control-sm ddl-novaon" ng-model="Filter.STATUS">
                                    <option value="" selected>Mặc định</option>
                                    <option value="0">Số HĐ tăng dần</option>
                                    <option value="1">Số HĐ giảm dần</option>
                                    <option value="2">Ngày tạo HĐ giảm dần </option>
                                    <option value="3">Ngày tạo HĐ tăng dần</option>
                                    <option value="4">Mã KH giảm dần</option>
                                    <option value="5">Mã KH tăng dần</option>
                                </select>
                            </div>

                            <div class="col-6">
                                <p class="mb-1">Ký hiệu</p>
                                <select class="form-control form-control-sm ddl-novaon" ng-model="Filter.SYMBOLCODE">
                                    <option value="" selected>Tất cả</option>
                                    <option ng-repeat="item in ListSymbolCode" value="{{item.SYMBOLCODE}}">{{item.SYMBOLCODE}}</option>
                                </select>

                                <p class="mb-1 mt-3">Số</p>
                                <input class="form-control form-control-sm" ng-model="Filter.NUMBER" placeholder="Số hóa đơn... (ví dụ: 0000009)" />
                                <p class="mb-1 mt-3">Thời gian</p>
                                <select class="form-control form-control-sm ddl-novaon" ng-model="Filter.TIME">
                                    <option value="{{null}}" selected>Tất cả</option>
                                    <option ng-repeat="t in Timepickers.Options" value="{{t.value}}">{{t.text}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="row" ng-show="(Filter.TIME == 5)">
                            <div class="col-6">
                                <p class="mb-1 mt-3">Từ ngày</p>
                                <input type="date" ng-model="FROMTIME" data-date-format="DD MMMM YYYY" id="pk_fromtimeError" class="w-100 form-control form-control-sm">
                            </div>
                            <div class="col-6">
                                <p class="mb-1 mt-3">Đến ngày</p>
                                <input type="date" ng-model="TOTIME" data-date-format="DD MMMM YYYY" id="pk_totimeError" class="w-100 form-control form-control-sm">
                            </div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mt-4">
                            <div class="keyword-filter">

                            </div>
                            <button class="btn btn-success btn-sm pl-5 pr-5" ng-click=" GetInvoiceReleaseError(1)">Lọc</button>
                        </div>
                    </form>
                </div>
            </div>

            <span class="has-tag" ng-repeat="f in FilterApply" ng-click="RemoveFilter(f)">{{f.value}} <img src="~/Images/close.png"></span>

            <div class="d-flex justify-content-between mt-2 custom-action">
                <div ng-if="Enterprise.ISFREETRIAL === false">
                    <span style="color:red;" id="div-sign-invoice-error"></span>
                    <div class="btn-group btn-sm" id="div-sign-invoice-error-detail" style="display:none;"><a class="dropdown-item" href="javascript:;"><i class="fa fa-view-o"></i> Chi tiết</a></div>
                    <button type="button" style="cursor:pointer;" class="btn btn-warning btn-sm" ng-click="MergingPdfFile()" ng-if="Enterprise.USINGINVOICETYPE == 4">
                        <svg version="1.1" id="Layer_1" xmlns="https://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 512 512" xml:space="preserve" style="height: 14px;width: 14px;" class="icon icon-sm align-text-bottom"><path d="M495 127h-76c-2.2 0-4-1.8-4-4V15c0-8.8-7.2-16-16-16H111c-8.8 0-16 7.2-16 16v108c0 2.2-1.8 4-4 4H15c-8.8 0-16 7.2-16 16v224c0 8.8 7.2 16 16 16h76c2.2 0 4 1.8 4 4l.4 108.6c0 8.8 7.2 15.9 16 15.9h288.1c8.8 0 16-7.2 16-16v-108c0-2.2 1.8-4 4-4l75.6-.4c8.8 0 15.9-7.2 15.9-16V143c0-8.8-7.2-16-16-16zM127 35c0-2.2 1.8-4 4-4h248c2.2 0 4 1.8 4 4v88c0 2.2-1.8 4-4 4H131c-2.2 0-4-1.8-4-4V35zm256.5 440.5c0 2.2-1.8 4-4 4h-248c-2.2 0-4-1.8-4-4v-152c0-2.2 1.8-4 4-4h248c2.2 0 4 1.8 4 4v152zm96-128.5c0 2.2-1.8 4-4 4H419c-2.2 0-4-1.8-4-4v-44c0-8.8-7.2-16-16-16H111c-8.8 0-16 7.2-16 16v44c0 2.2-1.8 4-4 4H35c-2.2 0-4-1.8-4-4V163c0-2.2 1.8-4 4-4l440.5.5c2.2 0 4 1.8 4 4V347z"></path><path d="M431.6 191.5h-32.3c-8.7 0-15.8 7.1-15.8 15.8v.3c0 8.7 7.1 15.8 15.8 15.8h32.3c8.7 0 15.8-7.1 15.8-15.8v-.3c0-8.7-7.1-15.8-15.8-15.8zM303.6 351.5H175.3c-8.7 0-15.8 7.1-15.8 15.8v.3c0 8.7 7.1 15.8 15.8 15.8h128.3c8.7 0 15.8-7.1 15.8-15.8v-.3c0-8.7-7.1-15.8-15.8-15.8zM239.6 415.5h-64.3c-8.7 0-15.8 7.1-15.8 15.8v.3c0 8.7 7.1 15.8 15.8 15.8h64.3c8.7 0 15.8-7.1 15.8-15.8v-.3c0-8.7-7.1-15.8-15.8-15.8z"></path></svg> In hóa đơn
                    </button>
                    <div class="d-flex align-items-end"><img src="~/Images/64px_corner-down-round.png" /></div>
                    <div class="btn-group">
                        <button type="button" class="btn btn-light btn-sm dropdown-toggle" data-toggle="dropdown">
                            Xử lý hàng loạt
                        </button>
                        <div class="dropdown-menu dropdown-menu-sm" aria-labelledby="dropdownMenuButton">
                            <span style="cursor:pointer;" ng-click="SignMultipleInvoice(false, false)">
                                Phát hành
                            </span>
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-center align-items-center">
                    <div class="button-circle-hover"><span title="Làm mới dữ liệu" class="fa fa-refresh" ng-repeat="f in FilterApply" ng-click="RemoveFilter(f)"></span></div>
                    <div class="button-circle-hover" data-toggle="dropdown">
                        <span title="Thiết lập cột hiển thị" class="fa fa-cog"></span>
                    </div>
                    <div class="dropdown-menu p-3" ng-init="LoadCookie_Invoice()">
                        <form class="frm_custom_view_column">
                            <p class="mb-0">Cột hiển thị</p>
                            <label for="cbx_invoice_formcode_error" class="label-cbx">
                                <input id="cbx_invoice_formcode_error" type="checkbox" class="invisible" ng-model="cookie.FieldFormCode" ng-click="Check(cookie.FieldFormCode,'FieldFormCode')">
                                <span class="checkbox">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20">
                                        <path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>
                                        <polyline points="4 11 8 15 16 6"></polyline>
                                    </svg>
                                </span>
                                <span class="cbx-text">Mẫu số/Ký hiệu</span>
                            </label>
                            <label for="cbx_invoice_number_error" class="label-cbx">
                                <input id="cbx_invoice_number_error" type="checkbox" class="invisible" ng-model="cookie.FieldNumber" ng-click="Check(cookie.FieldNumber,'FieldNumber')">
                                <span class="checkbox">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20">
                                        <path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>
                                        <polyline points="4 11 8 15 16 6"></polyline>
                                    </svg>
                                </span>
                                <span class="cbx-text">Số/Ngày hóa đơn</span>
                            </label>

                            <label for="cbx_invoice_customer_error" class="label-cbx">
                                <input id="cbx_invoice_customer_error" type="checkbox" class="invisible" ng-model="cookie.FieldCustomer" ng-click="Check(cookie.FieldCustomer,'FieldCustomer')">
                                <span class="checkbox">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20">
                                        <path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>
                                        <polyline points="4 11 8 15 16 6"></polyline>
                                    </svg>
                                </span>
                                <span class="cbx-text">Khách hàng</span>
                            </label>

                            <label for="cbx_invoice_invoicestatus_error" class="label-cbx">
                                <input id="cbx_invoice_invoicestatus_error" type="checkbox" class="invisible" ng-model="cookie.FieldBillType" ng-click="Check(cookie.FieldBillType,'cookie.FieldBillType')">
                                <span class="checkbox">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20">
                                        <path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>
                                        <polyline points="4 11 8 15 16 6"></polyline>
                                    </svg>
                                </span>
                                <span class="cbx-text">Trạng thái hóa đơn</span>
                            </label>

                            <label for="cbx_invoice_totalpayment_error" class="label-cbx">
                                <input id="cbx_invoice_totalpayment_error" type="checkbox" class="invisible" ng-model="cookie.FieldTotalPayment" ng-click="Check(cookie.FieldTotalPayment,'FieldTotalPayment')">
                                <span class="checkbox">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20">
                                        <path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>
                                        <polyline points="4 11 8 15 16 6"></polyline>
                                    </svg>
                                </span>
                                <span class="cbx-text">Tổng tiền</span>
                            </label>
                            @*<p class="mb-1 mt-3">Số dòng trên một trang</p>
                                <div class="d-flex align-items-center">
                                    <div class="pr-2">
                                        <select class="form-control form-control-sm" ng-model="cookie.RowNum" convert-to-number ng-change="Check(cookie.RowNum,'RowNum')">
                                            <option value="5">5</option>
                                            <option value="10">10</option>
                                            <option value="20">20</option>
                                            <option value="30">30</option>
                                            <option value="50">50</option>
                                            <option value="100">100</option>
                                            <option value="500">500</option>
                                            <option value="1000">1000</option>
                                        </select>
                                    </div>
                                    <span>dòng</span>
                                </div>*@
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <table id="dataTable_error" class="table table-bordered table-sm table-vertical-center table-head-green table-hover table_invoice_list_manage">
            <thead>
                <tr>
                    <th style="width: 2%;" class="text-center">
                        <label for="cbx_title_error" class="label-cbx">
                            <input id="cbx_title_error" type="checkbox" class="invisible" ng-click="SelectAllInvoice(ListInvoice, IsSelectAll)" ng-model="IsSelectAll" ng-init="IsSelectAll = false">
                            <span class="checkbox">
                                <svg width="20px" height="20px" viewBox="0 0 20 20">
                                    <path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>
                                    <polyline points="4 11 8 15 16 6"></polyline>
                                </svg>
                            </span>
                        </label>
                    </th>
                    <th class="text-center" ng-show="cookie.FieldID" style="width:5%">STT</th>
                    <th class="text-center" ng-show="cookie.FieldFormCode" style="width:8%">Mẫu số <br /> Ký hiệu</th>
                    <th class="text-center" ng-show="cookie.FieldNumber" style="width:8%">Số hóa đơn<br /> Ngày hóa đơn</th>
                    <th class="text-center" ng-click='sortColumn("CUSNAME")' ng-class='sortClass("CUSNAME")' ng-show="cookie.FieldCustomer">Khách hàng</th>
                    <th class="text-center" ng-click='sortColumn("INVOICETYPE")' ng-class='sortClass("INVOICETYPE")' ng-show="cookie.FieldBillType" style="width:10%">Trạng thái hóa đơn</th>
                    <th class="text-center" ng-show="cookie.FieldTotalPayment" style="width:8%">Tổng tiền (VNĐ)</th>
                    <th class="text-center" style="width:8%">Hành động</th>
                </tr>
            </thead>

            <tbody>
                <tr class="data" ng-hide="ListInvoice.length >= 1">
                    <td colspan="12">Dữ liệu đang trống!</td>
                </tr>
                <tr ng-repeat="item in ListInvoice" ng-dblclick="ModalInvoice(item,6 )">
                    <td class="text-center">
                        <label for="cbx_{{$index}}" class="label-cbx">
                            <input id="cbx_{{$index}}" type="checkbox" class="invisible" ng-model="item.ISSELECTED" ng-click="SeleteRow(ListInvoice, item.ISSELECTED, IsSelectAll, item.ID)">
                            <span class="checkbox" ng-model="item.ISSELECTED">
                                <svg width="20px" height="20px" viewBox="0 0 20 20">
                                    <path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>
                                    <polyline points="4 11 8 15 16 6"></polyline>
                                </svg>
                            </span>
                        </label>
                    </td>
                    <td class="text-center" ng-show="cookie.FieldID">{{$index + 1}}</td>
                    <td class="text-center" ng-show="cookie.FieldFormCode">{{item.FORMCODE}} <br /> {{item.SYMBOLCODE}}</td>
                    <td class="text-center" ng-show="cookie.FieldNumber" ng-if="item.NUMBER == 0"><b>[Chưa cấp số]</b></td>
                    <td class="text-center" ng-show="cookie.FieldNumber" ng-if="item.NUMBER > 0"><span class="text-danger"><b>{{item.NUMBER | numberFixedLen:7}}</b></span> <br /><i> {{item.SIGNEDTIME | dateFormat:'dd/MM/yyyy'}}</i></td>
                    <td class="text-left" ng-show="cookie.FieldCustomer" width="20%">{{item.CUSNAME}}</td>
                    <td ng-show="cookie.FieldBillType" class="">
                        <span class=" text-primary" ng-show="item.INVOICETYPE == 1">
                            {{item.INVOICETYPENAME}}
                        </span>
                        <span class=" text-primary" ng-show="item.INVOICETYPE == 2">
                            {{item.INVOICETYPENAME}}
                        </span>
                        <span class=" text-black-50" ng-show="item.INVOICETYPE == 3">
                            {{item.INVOICETYPENAME}}
                        </span>
                        <span class=" text-warning" ng-show="item.INVOICETYPE == 4">
                            {{item.INVOICETYPENAME}}
                        </span>
                        <span class=" text-danger" ng-show="item.INVOICETYPE == 5">
                            {{item.INVOICETYPENAME}}
                        </span>
                        <span class=" text-info" ng-show="item.INVOICETYPE == 6">
                            {{item.INVOICETYPENAME}}
                        </span>
                    </td>
                    <td ng-show="cookie.FieldTotalPayment" class="text-right">{{item.TOTALPAYMENT | numberFormat: (item.CURRENCY != 'VND' ? 2 : 0)}}</td>
                    <td class="text-center" style="width:8%">
                        <div class="btn-group btn-sm">
                            <button class="btn btn-link btn-sm" href="javascript:;" ng-click="ModalInvoice(item, 2)" data-toggle="modal" data-target=".modal-invoice"><span class="fa fa-pencil-square-o color_btn" title="Sửa"></span></button>
                            <button class="btn btn-link btn-sm" @*ng-if="item.SIGNLINK === null"*@ href="javascript:;" ng-click="PreviewInvoice(item.ID, false)"><span class="fa fa-eye color_btn" title="Xem file HĐ"></span></button>
                            <button class="btn btn-link btn-sm" href="javascript:;" ng-click="Sign(item.ID)"><img src="/Images/hand-writing-with-ballpen.svg" style="width: 16px;" title="Phát hành lại"></button>
                        </div>
                    </td>
                </tr>
            </tbody>

        </table>
        <div class="d-none d-sm-block">
            <table class="table table-bordered table-sm table-vertical-center table-head-green table-hover" ng-hide="ListInvoice.length < 1">
                <tfoot>
                    <tr>
                        <td class="border-0"></td>
                        <td class="text-right border-0 font-weight-bold">
                            TỔNG: {{ListInvoice|sumTotal:'TOTALPAYMENT'|numberFormat:0}} VNĐ
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>