@*Hóa đơn hủy bỏ*@
<div ng-show="Tab.Cancel">
    <div class="bg-white border mt-2 ">
        @*Bô lọc*@
        <div class="header-filter px-3 p-2 d-none d-sm-block">
            <div class="d-flex justify-content-between mt-2">
                <div class="btn-group btn-filter">
                    <button type="button" class="btn btn-light btn-sm dropdown-toggle" data-toggle="dropdown">
                        <span class="fa fa-filter"></span> Bộ lọc
                    </button>
                    <div class="dropdown-menu p-3">
                        <form id="frmInvoiceFilterCancel">
                            <div class="row">
                                <div class="col-6">
                                    <p class="mb-1 mt-3">Mẫu số</p>
                                    <select class="form-control form-control-sm ddl-novaon" ng-model="Filter.FORMCODE">
                                        <option value="" selected>Tất cả</option>
                                        <option ng-repeat="item in ListFormCode" value="{{item.FORMCODE}}">{{item.FORMCODE}}</option>
                                    </select>


                                    <p class="mb-1 mt-3">Khách hàng</p>
                                    <input class="form-control form-control-sm" ng-model="Filter.CUSTOMER" placeholder="Tên doanh nghiệp..." />

                                    <p class="mb-1 mt-3">Thời gian</p>
                                    <select class="form-control form-control-sm ddl-novaon" ng-model="Filter.TIME">
                                        <option value="{{null}}" disabled selected>Chọn thời gian</option>
                                        <option ng-repeat="t in Timepickers.Options" value="{{t.value}}">{{t.text}}</option>
                                    </select>

                                </div>

                                <div class="col-6">
                                    <p class="mb-1 mt-3">Ký hiệu</p>
                                    <select class="form-control form-control-sm ddl-novaon" ng-model="Filter.SYMBOLCODE">
                                        <option value="" disabled selected>Chọn ký hiệu</option>
                                        <option ng-repeat="item in ListSymbolCode" value="{{item.SYMBOLCODE}}">{{item.SYMBOLCODE}}</option>
                                    </select>

                                    <p class="mb-1 mt-3">Số</p>
                                    <input class="form-control form-control-sm" ng-model="Filter.NUMBER" placeholder="Số hóa đơn... (ví dụ: 0000009)" />
                                </div>
                            </div>
                            <div class="row" ng-show="(Filter.TIME == 5)">
                                <div class="col-6">
                                    <p class="mb-1 mt-3">Từ ngày</p>
                                    <input type="date" ng-model="FROMTIME" data-date-format="DD MMMM YYYY" id="pk_fromtimecancel" class="w-100 form-control form-control-sm">
                                </div>
                                <div class="col-6">
                                    <p class="mb-1 mt-3">Đến ngày</p>
                                    <input type="date" ng-model="TOTIME" data-date-format="DD MMMM YYYY" id="pk_totimecancel" class="w-100 form-control form-control-sm">
                                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mt-4">
                                <div class="keyword-filter">

                                </div>
                                <button class="btn btn-success btn-sm pl-5 pr-5" ng-click="GetInvoiceByStatus(3, 1, 1)">Lọc</button>
                            </div>
                        </form>
                    </div>
                    @* Gán thẻ đã lọc *@
                    <span class="has-tag" ng-repeat="f in FilterApply" ng-click="RemoveFilter(f)">{{f.value}} <img src="~/Images/close.png"></span>
                </div>
            </div>
        </div>

        @*Table*@
        @*Desktop*@
        <div class="d-none d-sm-block">
            <table class="table table-bordered table-sm table-vertical-center table-head-green table-hover">
                <thead>
                    <tr>
                        <th class="text-center" style="width:6%;">STT</th>
                        <th style="width:10%;">Ngày tạo</th>
                        <th style="width:8%;">Mẫu số <br />Ký hiệu</th>
                        <th class="text-right" style="width:7%;">Số hóa đơn</th>
                        <th class="text-right" style="width:10%;">Tổng tiền</th>
                        <th style="width:10%">Ngày hủy hóa đơn </th>
                        <th>Lý do hủy</th>
                        <th class="text-center">Biên bản đính kèm</th>
                        <th class="text-center">Tạo biên bản</th>
                        <th class="text-center">Trạng thái biên bản</th>
                        <th style="width:7%;"></th>
                    </tr>
                </thead>

                <tbody>
                    <tr class="data" ng-hide="ListInvoice.length >= 1">
                        <td colspan="12">Dữ liệu đang trống!</td>
                    </tr>
                    <tr ng-repeat="item in ListInvoice" style="cursor:pointer">
                        <td class="text-center">{{$index + 1}}</td>
                        <td>{{item.INITTIME | dateTimeFormat}}</td>
                        <td>{{item.FORMCODE}} <br /> {{item.SYMBOLCODE}}</td>
                        <td class="text-right" ng-if="item.NUMBER == 0">0000000</td>
                        <td class="text-right text-danger" ng-if="item.NUMBER > 0">{{item.NUMBER | numberFixedLen:7}}</td>
                        <td class="text-right">{{item.TOTALPAYMENT | numberFormat: (item.CURRENCY != 'VND' ? 2 : 0)}}</td>
                        <td>{{item.CANCELTIME | dateFormat: 'dd/MM/yyyy'}} </td>
                        <td> {{item.CANCELREASON}}</td>

                        <td class="text-center" width="10%" ng-if="!item.ATTACHMENTFILELINK">
                            <label data-toggle="tooltip" data-placement="bottom" title="Chọn file dữ liệu">
                                <button type="button" class="btn btn-light btn-link color_btn" ng-click="OpenModalUploadFileReport(item)">
                                    <span class="fa fa-paperclip"></span>
                                </button>
                            </label>
                        </td>
                        <td class="text-center" width="10%" ng-if="item.ATTACHMENTFILELINK">
                            <label data-toggle="tooltip" data-placement="bottom" title="Xóa file dữ liệu">
                                <button type="button" class="btn btn-light btn-link color_btn" ng-click="RemoveFileReport(item)">
                                    <span class="fa fa-times"></span>
                                </button>
                            </label>
                            <label data-toggle="tooltip" data-placement="bottom" title="Tải xuống file dữ liệu">
                                <button type="button" class="btn btn-light btn-link color_btn" ng-click="DownloadFileReport(item)">
                                    <span class="fa fa-download"></span>
                                </button>
                            </label>
                        </td>
                        @*Tạo biên bản*@
                        <td class="text-center" width="10%">
                            <label data-toggle="tooltip" data-placement="bottom" title="Chỉnh sửa" has-permission="{{USER_ROLE.THEM_MOI_HOA_DON}}">
                                <button type="button" class="btn btn-light btn-link btn-sm color_btn" ng-if="!(item.ISEXISTCANCELREPORT == '1')" ng-click="OpenModalCancelReport(item);">
                                    <span class="fa fa-plus"></span>
                                </button>
                            </label>
                            <span class="text-danger" ng-if="item.ISEXISTCANCELREPORT == '1'">Đã tồn tại biên bản</span>
                        </td>

                        <td class="text-center" width="10%">{{item.REPORTSTATUSNAME}}</td>
                        <td class="text-right" width="5%">
                            <label data-toggle="tooltip" data-placement="bottom" title="Chỉnh sửa" has-permission="{{USER_ROLE.CAP_NHAT_HOA_DON}}" ng-if="!(item.REPORTSTATUSNAME == 'Đã ký')">
                                <button type="button" class="btn btn-light btn-link btn-sm color_btn" ng-click="OpenModalCancelReport(item, 2);">
                                    <span class="fa fa-edit"></span>
                                </button>
                            </label>
                            <label data-toggle="tooltip" data-placement="bottom" title="Xem trước" has-permission="{{USER_ROLE.XEM_HOA_DON}}">
                                <button type="button" class="btn btn-light btn-link btn-sm color_btn" ng-if="item.ISEXISTCANCELREPORT == '1'" ng-click="PreviewCancelReport(item)">
                                    <span class="fa fa-eye"></span>
                                </button>
                            </label>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    @*Modal upload file biên bản*@
    <div id="modal_upload_file_report" style="display: none; padding-left: 0!important; padding-right: 0!important" title="Tải lên file biên bản">
        <div class="form-group">
            <div class="d-flex">
                <div class="col-12">
                    <label> Biên bản hủy cho hóa đơn số: <span class="text-danger">{{CurrentInvoiceFileReport.NUMBER | numberFixedLen:7}}</span> mẫu số: {{CurrentInvoiceFileReport.FORMCODE}}-{{CurrentInvoiceFileReport.SYMBOLCODE}} </label>
                    <label class="drop-file-box">
                        <span class="fa fa-cloud-upload" aria-hidden="true"></span>
                        <span>Kéo thả tập tin ở đây hoặc nhấn vào biếu tượng <br />Tối đa: 5 MB | Định dạng: Pdf. Doc, Docx</span>
                        <form id="frmUploadFileReport" class="display-none">
                            <input id="fileUploadInvoice" type="file" name="fileUploadReport" accept=".doc, .docx, .pdf, .txt" >
                        </form>
                    </label>
               </div>
            </div>
        </div>
        <div class="modal-footer d-flex justify-content-between p-0 pt-2">
            <div class="d-flex justify-content-start">
            </div>
            <div class="d-flex justify-content-between">
                @*<button class="btn btn-success mr-3" ng-click="ConvertInvoices()">  &nbsp; Tiếp tục </button>*@
            </div>
        </div>
    </div>
</div>